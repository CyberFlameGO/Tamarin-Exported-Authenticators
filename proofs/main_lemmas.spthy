theory ExportedAuthenticators_lemmas begin

// Function signature and definition of the equational theory E

functions: Expand/3, Exporter/3, Extract/2, adec/2, aenc/2, fst/1,
           h/1, hmac/1, mac/1, mask/2, pair/2, pk/1, sign/2, snd/1, true/0,
           unmask/2, verify/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    unmask(mask(x, y), x) = y,
    unmask(mask(x, y), y) = x,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true

section{* TLS Exported Authenticators*}

restriction Eq_check_succeed:
  "∀ x y #i. (Eq( x, y ) @ #i) ⇒ (x = y)"
  // safety formula

restriction Neq_check_succeed:
  "∀ x y #i. (Neq( x, y ) @ #i) ⇒ (¬(x = y))"
  // safety formula

restriction pair_or_swapped:
  "∀ x y a b #i.
    (Check_pair_or_swapped( x, y, a, b ) @ #i) ⇒
    (((x = a) ∧ (y = b)) ∨ ((x = b) ∧ (y = a)))"
  // safety formula

rule (modulo E) Reveal_ltk:
   [ !Ltk( A, ltk ) ] --[ RevLtk( A ) ]-> [ Out( ltk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_Adv_TLS_channel:
   [ Fr( ms ), Fr( TLS_transcript ), Fr( ~owner_cid ), Fr( cid ) ]
  --[ Adv_TLS( $I, ~owner_cid ) ]->
   [
   !TLS_Channel( ms, TLS_transcript, 'uni', $I, ~owner_cid, $S, cid ),
   !Exporters( ms, 'server', cid,
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32')
   ),
   ServerStart( cid ),
   Out( <~owner_cid, 
         Expand(Expand(Expand(ms,
                              <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                       <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 'empty'>,
                       '32'),
                <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
         Expand(Expand(Expand(ms,
                              <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                       <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 'empty'>,
                       '32'),
                <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
         Expand(Expand(Expand(ms,
                              <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                       <'32', 'EXPORTER_clientauthenticatorfinishedkey', 'empty'>, '32'),
                <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
         Expand(Expand(Expand(ms,
                              <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                       <'32', 'EXPORTER_serverauthenticatorfinishedkey', 'empty'>, '32'),
                <'32', 'exporter', h(<'empty', '32'>)>, '32')
        >
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adv_Send_TLS:
   [
   In( <~owner_cid, m> ),
   !TLS_Channel( ms, TLS_transcript, auth_status, $I, ~owner_cid, $S,
                 cid
   )
   ]
  --[ A_Send( ~owner_cid ) ]->
   [ TLS_Send( ~owner_cid, $I, $S, m ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Adv_Recv_TLS:
   [ TLS_Recv( ~owner_cid, from_host, to_host, msg ), In( ~owner_cid )
   ]
  --[ A_Recv( ~owner_cid ) ]->
   [ Out( <from_host, to_host, msg> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_pk:
   [ Fr( ~ltk ) ]
  -->
   [ !Ltk( $A, ~ltk ), !Pk( $A, pk(~ltk) ), DelegateLtk( $TP, ~ltk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Get_pk:
   [ !Pk( A, pubkey ) ] --> [ Out( pubkey ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_TLS_channel_bi:
   [
   Fr( ms ), Fr( TLS_transcript ), Fr( cid ),
   Create_TLS_Channel( owner_host, owner_cid, target_host )
   ]
  --[ SessionKey( ms, TLS_transcript ) ]->
   [
   !TLS_Channel( ms, TLS_transcript, 'bi', owner_host, owner_cid,
                 target_host, cid
   ),
   !Exporters( ms, 'server', cid,
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32')
   ),
   ServerStart( cid ),
   !Exporters( ms, 'client', owner_cid,
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32')
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_TLS_channel_uni:
   [
   Fr( ms ), Fr( TLS_transcript ), Fr( cid ),
   Create_TLS_Channel( owner_host, owner_cid, target_host )
   ]
  --[ SessionKey( ms, TLS_transcript ) ]->
   [
   !TLS_Channel( ms, TLS_transcript, 'uni', 'place_holder', owner_cid,
                 target_host, cid
   ),
   !Exporters( ms, 'server', cid,
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32')
   ),
   ServerStart( cid ),
   !Exporters( ms, 'client', owner_cid,
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 'empty'>,
                             '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_clientauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32'),
               Expand(Expand(Expand(ms,
                                    <'32', 'TLS13exportermastersecret', h(TLS_transcript)>, '32'),
                             <'32', 'EXPORTER_serverauthenticatorfinishedkey', 'empty'>, '32'),
                      <'32', 'exporter', h(<'empty', '32'>)>, '32')
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Send_TLS_Channel_owner_bi:
   [
   TLS_Send( cid, from_host, to_host, msg ),
   !TLS_Channel( ms, TLS_transcript, 'bi', owner_host, owner_cid,
                 target_host, target_cid
   )
   ]
  --[
  Check_pair_or_swapped( from_host, to_host, owner_host, target_host
  ),
  Eq( cid, owner_cid )
  ]->
   [ TLS_Recv( target_cid, from_host, to_host, msg ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Send_TLS_Channel_owner_uni:
   [
   TLS_Send( cid, from_host, to_host, msg ),
   !TLS_Channel( ms, TLS_transcript, 'uni', owner_host, owner_cid,
                 target_host, target_cid
   )
   ]
  --[ Eq( to_host, target_host ), Eq( cid, owner_cid ) ]->
   [ TLS_Recv( target_cid, owner_host, to_host, msg ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Send_TLS_Channel_target:
   [
   TLS_Send( cid, from_host, to_host, msg ),
   !TLS_Channel( ms, TLS_transcript, auth_status, owner_host,
                 owner_cid, target_host, target_cid
   )
   ]
  --[
  Check_pair_or_swapped( from_host, to_host, owner_host, target_host
  ),
  Eq( cid, target_cid )
  ]->
   [ TLS_Recv( owner_cid, from_host, to_host, msg ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) C_0:
   [ Fr( ~tid ) ]
  --[ Start( ~tid, $C, $S, 'client' ), C0( ~tid ) ]->
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   Create_TLS_Channel( $C, ~tid, $S )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) C_Request:
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   Fr( ~certificate_request_context )
   ]
  --[
  C_Req( ~tid, ~certificate_request_context ),
  Instance( ~tid, $C, $S, 'client' ),
  Requested( ~tid, $C, 'client',
             <'13', ~certificate_request_context, $certificate_extensions>
  )
  ]->
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   TLS_Send( ~tid, $C, $S,
             <'13', ~certificate_request_context, $certificate_extensions>
   ),
   PendingReq( ~tid,
               <'13', ~certificate_request_context, $certificate_extensions>
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) C_RecvReq:
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   TLS_Recv( ~tid, $S, $PH,
             <'13', certificate_request_context, $certificate_extensions>
   ),
   !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms )
   ]
  --[
  C_RecvReq( ~tid ),
  RecvReq( $C, ~ms, 'client',
           <'13', certificate_request_context, $certificate_extensions>
  ),
  Instance( ~tid, $C, $S, 'client' )
  ]->
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   PendingReq( ~tid,
               <'13', certificate_request_context, $certificate_extensions>
   )
   ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) C_Send:
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   PendingReq( ~tid,
               <'13', ~certificate_request_context, $certificate_extensions>
   ),
   !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms ),
   !Ltk( $A, ~ltkA ), DelegateLtk( $C, ~ltkA )
   ]
  --[
  C_Send( ~tid ), Owns( $C, ~ms, 'client', <$A, ~ltkA> ),
  Instance( ~tid, $C, $S, 'client' ),
  Fulfil( ~tid, $C, 'client',
          <'13', ~certificate_request_context, $certificate_extensions>,
          <$A, pk(~ltkA)>
  )
  ]->
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   TLS_Send( ~tid, $C, $S,
             <<'11', ~certificate_request_context, pk(~ltkA)>, 
              <'15', 
               sign(<'ExportedAuthenticator', 
                     h(<hccc, 
                        <'13', ~certificate_request_context, $certificate_extensions>, 
                        pk(~ltkA)>)
                    >,
                    ~ltkA)
              >, 
              '20', 
              hmac(<fmc, hccc, 
                    <'13', ~certificate_request_context, $certificate_extensions>, 
                    <'11', ~certificate_request_context, pk(~ltkA)>, '15', 
                    sign(<'ExportedAuthenticator', 
                          h(<hccc, 
                             <'13', ~certificate_request_context, $certificate_extensions>, 
                             pk(~ltkA)>)
                         >,
                         ~ltkA)
                   >)
             >
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) C_Recv:
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   TLS_Recv( ~tid, $PH, $S,
             <<'11', certificate_request_context, pk(~ltkA)>, 
              <'15', signature>, '20', verify_data>
   ),
   PendingReq( ~tid,
               <'13', certificate_request_context, $certificate_extensions>
   ),
   !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms ),
   !Pk( $A, pk(~ltkA) )
   ]
  --[
  C_Recv( ~tid ),
  Eq( verify(signature,
             <'ExportedAuthenticator', 
              h(<hccs, 
                 <'13', certificate_request_context, $certificate_extensions>, 
                 pk(~ltkA)>)
             >,
             pk(~ltkA)),
      true
  ),
  Eq( verify_data,
      hmac(<fms, hccs, 
            <'13', certificate_request_context, $certificate_extensions>, 
            <'11', certificate_request_context, pk(~ltkA)>, '15', signature>)
  ),
  Recv( $C, ~ms, 'client', <$A, pk(~ltkA)> ),
  Fulfilled( ~tid, $C, 'client',
             <'13', certificate_request_context, $certificate_extensions>,
             <$A, pk(~ltkA)>
  ),
  Instance( ~tid, $C, $S, 'client' )
  ]->
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   !AcceptOwnership( ~tid, $C, $S, pk(~ltkA) )
   ]

  // loop breaker: [0]
  /*
  rule (modulo AC) C_Recv:
     [
     State( ~tid, 'C0', $C, $S, 'client' ),
     TLS_Recv( ~tid, $PH, $S,
               <<'11', certificate_request_context, pk(~ltkA)>, 
                <'15', signature>, '20', verify_data>
     ),
     PendingReq( ~tid,
                 <'13', certificate_request_context, $certificate_extensions>
     ),
     !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms ),
     !Pk( $A, pk(~ltkA) )
     ]
    --[
    C_Recv( ~tid ), Eq( z, true ),
    Eq( verify_data,
        hmac(<fms, hccs, 
              <'13', certificate_request_context, $certificate_extensions>, 
              <'11', certificate_request_context, pk(~ltkA)>, '15', signature>)
    ),
    Recv( $C, ~ms, 'client', <$A, pk(~ltkA)> ),
    Fulfilled( ~tid, $C, 'client',
               <'13', certificate_request_context, $certificate_extensions>,
               <$A, pk(~ltkA)>
    ),
    Instance( ~tid, $C, $S, 'client' )
    ]->
     [
     State( ~tid, 'C0', $C, $S, 'client' ),
     !AcceptOwnership( ~tid, $C, $S, pk(~ltkA) )
     ]
    variants (modulo AC)
    1. $certificate_extensions
             = $certificate_extensions.32
       ~ltkA = ~ltkA.33
       certificate_request_context
             = certificate_request_context.36
       hccs  = hccs.40
       signature
             = sign(<'ExportedAuthenticator', 
                     h(<hccs.40, 
                        <'13', certificate_request_context.36, $certificate_extensions.32
                        >, 
                        pk(~ltkA.33)>)
                    >,
                    ~ltkA.33)
       z     = true
    
    2. $certificate_extensions
             = $certificate_extensions.33
       ~ltkA = ~ltkA.34
       certificate_request_context
             = certificate_request_context.37
       hccs  = hccs.41
       signature
             = signature.42
       z     = verify(signature.42,
                      <'ExportedAuthenticator', 
                       h(<hccs.41, 
                          <'13', certificate_request_context.37, $certificate_extensions.33
                          >, 
                          pk(~ltkA.34)>)
                      >,
                      pk(~ltkA.34))
    // loop breaker: [0]
  */

rule (modulo E) C_Recv_Spontaneous:
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   TLS_Recv( ~tid, $PH, $S,
             <<'11', pk(~ltkA)>, <'15', signature>, '20', verify_data>
   ),
   !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms ),
   !Pk( $A, pk(~ltkA) )
   ]
  --[
  C_Recv( ~tid ),
  Eq( verify(signature,
             <'ExportedAuthenticator', h(<hccs, pk(~ltkA)>)>, pk(~ltkA)),
      true
  ),
  Eq( verify_data,
      hmac(<fms, hccs, <'11', pk(~ltkA)>, '15', signature>)
  ),
  Recv( $C, ~ms, 'client', <$A, pk(~ltkA)> ),
  Instance( ~tid, $C, $S, 'client' )
  ]->
   [
   State( ~tid, 'C0', $C, $S, 'client' ),
   !AcceptOwnership( ~tid, $C, $S, pk(~ltkA) )
   ]

  // loop breaker: [0]
  /*
  rule (modulo AC) C_Recv_Spontaneous:
     [
     State( ~tid, 'C0', $C, $S, 'client' ),
     TLS_Recv( ~tid, $PH, $S,
               <<'11', pk(~ltkA)>, <'15', signature>, '20', verify_data>
     ),
     !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms ),
     !Pk( $A, pk(~ltkA) )
     ]
    --[
    C_Recv( ~tid ), Eq( z, true ),
    Eq( verify_data,
        hmac(<fms, hccs, <'11', pk(~ltkA)>, '15', signature>)
    ),
    Recv( $C, ~ms, 'client', <$A, pk(~ltkA)> ),
    Instance( ~tid, $C, $S, 'client' )
    ]->
     [
     State( ~tid, 'C0', $C, $S, 'client' ),
     !AcceptOwnership( ~tid, $C, $S, pk(~ltkA) )
     ]
    variants (modulo AC)
    1. ~ltkA = ~ltkA.27
       hccs  = hccs.33
       signature
             = sign(<'ExportedAuthenticator', h(<hccs.33, pk(~ltkA.27)>)>,
                    ~ltkA.27)
       z     = true
    
    2. ~ltkA = ~ltkA.28
       hccs  = hccs.34
       signature
             = signature.35
       z     = verify(signature.35,
                      <'ExportedAuthenticator', h(<hccs.34, pk(~ltkA.28)>)>,
                      pk(~ltkA.28))
    // loop breaker: [0]
  */

rule (modulo E) S_0:
   [
   !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms ),
   ServerStart( ~tid )
   ]
  --[ Start( ~tid, $S, $C, 'server' ), S0( ~tid ) ]->
   [ State( ~tid, 'S0', $S, $C, 'server' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) S_Request:
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   Fr( ~certificate_request_context )
   ]
  --[
  S_Req( ~tid, ~certificate_request_context ),
  Instance( ~tid, $S, $C, 'server' ),
  Requested( ~tid, $S, 'server',
             <'13', ~certificate_request_context, $certificate_extensions>
  )
  ]->
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   TLS_Send( ~tid, $C, $S,
             <'13', ~certificate_request_context, $certificate_extensions>
   ),
   PendingReq( ~tid,
               <'13', ~certificate_request_context, $certificate_extensions>
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) S_RecvReq:
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   TLS_Recv( ~tid, $C, $S,
             <'13', certificate_request_context, $certificate_extensions>
   ),
   !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms )
   ]
  --[
  S_RecvReq( ~tid ),
  RecvReq( $S, ~ms, 'server',
           <'13', certificate_request_context, $certificate_extensions>
  ),
  Instance( ~tid, $S, $C, 'server' )
  ]->
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   PendingReq( ~tid,
               <'13', certificate_request_context, $certificate_extensions>
   )
   ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) S_Send:
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   PendingReq( ~tid,
               <'13', ~certificate_request_context, $certificate_extensions>
   ),
   !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms ),
   !Ltk( $A, ~ltkA ), DelegateLtk( $S, ~ltkA )
   ]
  --[
  S_Send( ~tid ), Owns( $S, ~ms, 'server', <$A, ~ltkA> ),
  Instance( ~tid, $S, $C, 'server' ),
  Fulfil( ~tid, $S, 'server',
          <'13', ~certificate_request_context, $certificate_extensions>,
          <$A, ~ltkA>
  )
  ]->
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   TLS_Send( ~tid, $C, $S,
             <<'11', ~certificate_request_context, pk(~ltkA)>, 
              <'15', 
               sign(<'ExportedAuthenticator', 
                     h(<hccs, 
                        <'13', ~certificate_request_context, $certificate_extensions>, 
                        pk(~ltkA)>)
                    >,
                    ~ltkA)
              >, 
              '20', 
              hmac(<fms, hccs, 
                    <'13', ~certificate_request_context, $certificate_extensions>, 
                    <'11', ~certificate_request_context, pk(~ltkA)>, '15', 
                    sign(<'ExportedAuthenticator', 
                          h(<hccs, 
                             <'13', ~certificate_request_context, $certificate_extensions>, 
                             pk(~ltkA)>)
                         >,
                         ~ltkA)
                   >)
             >
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) S_Recv:
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   TLS_Recv( ~tid, $C, $S,
             <<'11', certificate_request_context, pk(~ltkA)>, 
              <'15', signature>, '20', verify_data>
   ),
   PendingReq( ~tid,
               <'13', certificate_request_context, $certificate_extensions>
   ),
   !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms ),
   !Pk( $A, pk(~ltkA) )
   ]
  --[
  S_Recv( ~tid ),
  Eq( verify(signature,
             <'ExportedAuthenticator', 
              h(<hccc, 
                 <'13', certificate_request_context, $certificate_extensions>, 
                 pk(~ltkA)>)
             >,
             pk(~ltkA)),
      true
  ),
  Eq( verify_data,
      hmac(<fmc, hccc, 
            <'13', certificate_request_context, $certificate_extensions>, 
            <'11', certificate_request_context, pk(~ltkA)>, '15', signature>)
  ),
  Recv( $S, ~ms, 'server', <$A, pk(~ltkA)> ),
  Fulfilled( ~tid, $S, 'server',
             <'13', certificate_request_context, $certificate_extensions>,
             <$A, pk(~ltkA)>
  ),
  Instance( ~tid, $S, $C, 'server' )
  ]->
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   !AcceptOwnership( ~tid, $C, $S, pk(~ltkA) )
   ]

  // loop breaker: [0]
  /*
  rule (modulo AC) S_Recv:
     [
     State( ~tid, 'S0', $S, $C, 'server' ),
     TLS_Recv( ~tid, $C, $S,
               <<'11', certificate_request_context, pk(~ltkA)>, 
                <'15', signature>, '20', verify_data>
     ),
     PendingReq( ~tid,
                 <'13', certificate_request_context, $certificate_extensions>
     ),
     !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms ),
     !Pk( $A, pk(~ltkA) )
     ]
    --[
    S_Recv( ~tid ), Eq( z, true ),
    Eq( verify_data,
        hmac(<fmc, hccc, 
              <'13', certificate_request_context, $certificate_extensions>, 
              <'11', certificate_request_context, pk(~ltkA)>, '15', signature>)
    ),
    Recv( $S, ~ms, 'server', <$A, pk(~ltkA)> ),
    Fulfilled( ~tid, $S, 'server',
               <'13', certificate_request_context, $certificate_extensions>,
               <$A, pk(~ltkA)>
    ),
    Instance( ~tid, $S, $C, 'server' )
    ]->
     [
     State( ~tid, 'S0', $S, $C, 'server' ),
     !AcceptOwnership( ~tid, $C, $S, pk(~ltkA) )
     ]
    variants (modulo AC)
    1. $certificate_extensions
             = $certificate_extensions.30
       ~ltkA = ~ltkA.31
       certificate_request_context
             = certificate_request_context.34
       hccc  = hccc.37
       signature
             = sign(<'ExportedAuthenticator', 
                     h(<hccc.37, 
                        <'13', certificate_request_context.34, $certificate_extensions.30
                        >, 
                        pk(~ltkA.31)>)
                    >,
                    ~ltkA.31)
       z     = true
    
    2. $certificate_extensions
             = $certificate_extensions.32
       ~ltkA = ~ltkA.33
       certificate_request_context
             = certificate_request_context.36
       hccc  = hccc.39
       signature
             = signature.41
       z     = verify(signature.41,
                      <'ExportedAuthenticator', 
                       h(<hccc.39, 
                          <'13', certificate_request_context.36, $certificate_extensions.32
                          >, 
                          pk(~ltkA.33)>)
                      >,
                      pk(~ltkA.33))
    // loop breaker: [0]
  */

rule (modulo E) S_Send_Spontaneous:
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms ),
   !Ltk( $A, ~ltkA ), DelegateLtk( $S, ~ltkA )
   ]
  --[
  S_Send( ~tid ), Owns( $S, ~ms, 'server', <$A, ~ltkA> ),
  Instance( ~tid, $S, $C, 'server' )
  ]->
   [
   State( ~tid, 'S0', $S, $C, 'server' ),
   TLS_Send( ~tid, $C, $S,
             <<'11', pk(~ltkA)>, 
              <'15', sign(<'ExportedAuthenticator', h(<hccs, pk(~ltkA)>)>, ~ltkA)
              >, 
              '20', 
              hmac(<fms, hccs, <'11', pk(~ltkA)>, '15', 
                    sign(<'ExportedAuthenticator', h(<hccs, pk(~ltkA)>)>, ~ltkA)>)
             >
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

lemma uniq_Start:
  all-traces
  "∀ tid actor1 actor2 peer1 peer2 role1 role2 #i #j.
    ((Start( tid, actor1, peer1, role1 ) @ #i) ∧
     (Start( tid, actor2, peer2, role2 ) @ #j)) ⇒
    ((((#i = #j) ∧ (actor1 = actor2)) ∧ (peer1 = peer2)) ∧
     (role1 = role2))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor1 actor2 peer1 peer2 role1 role2 #i #j.
  (Start( tid, actor1, peer1, role1 ) @ #i) ∧
  (Start( tid, actor2, peer2, role2 ) @ #j)
 ∧
  ((¬(#i = #j)) ∨
   (¬(actor1 = actor2)) ∨
   (¬(peer1 = peer2)) ∨
   (¬(role1 = role2)))"
*/
simplify
solve( Start( tid, actor1, peer1, role1 ) @ #i )
  case C_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case C_0
    by contradiction /* from formulas */
  next
    case S_0
    by solve( ServerStart( ~tid ) ▶₁ #j )
  qed
next
  case S_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case C_0
    by solve( ServerStart( ~tid ) ▶₁ #i )
  next
    case S_0
    solve( ServerStart( ~tid ) ▶₁ #j )
      case Create_Adv_TLS_channel
      solve( ServerStart( ~tid ) ▶₁ #i )
        case Create_Adv_TLS_channel
        by contradiction /* from formulas */
      qed
    next
      case Create_TLS_channel_bi
      solve( ServerStart( ~tid ) ▶₁ #i )
        case Create_TLS_channel_bi
        by contradiction /* from formulas */
      qed
    next
      case Create_TLS_channel_uni
      solve( ServerStart( ~tid ) ▶₁ #i )
        case Create_TLS_channel_uni
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

lemma tid_invariant [use_induction, reuse]:
  all-traces
  "∀ tid actor peer role #i.
    (Instance( tid, actor, peer, role ) @ #i) ⇒
    (∃ #j. (Start( tid, actor, peer, role ) @ #j) ∧ (#j < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role #i.
  (Instance( tid, actor, peer, role ) @ #i)
 ∧
  ∀ #j. (Start( tid, actor, peer, role ) @ #j) ⇒ ¬(#j < #i)"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (last(#i))  ∥
         (∃ #j.
           (Start( tid, actor, peer, role ) @ #j)
          ∧
           (¬(last(#j))) ∧ (#j < #i)) )
    case case_1
    solve( Instance( tid, actor, peer, role ) @ #i )
      case C_Recv
      solve( State( ~tid, 'C0', $C, $S, 'client' ) ▶₀ #i )
        case C_0
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_case_01
        by contradiction /* from formulas */
      next
        case C_Recv_case_02
        by contradiction /* from formulas */
      next
        case C_Recv_case_03
        by contradiction /* from formulas */
      next
        case C_Recv_case_04
        by contradiction /* from formulas */
      next
        case C_Recv_case_05
        by contradiction /* from formulas */
      next
        case C_Recv_case_06
        by contradiction /* from formulas */
      next
        case C_Recv_case_07
        by contradiction /* from formulas */
      next
        case C_Recv_case_08
        by contradiction /* from formulas */
      next
        case C_Recv_case_09
        by contradiction /* from formulas */
      next
        case C_Recv_case_10
        by contradiction /* from formulas */
      next
        case C_Request
        by contradiction /* from formulas */
      next
        case C_Send_case_1
        by contradiction /* from formulas */
      next
        case C_Send_case_2
        by contradiction /* from formulas */
      next
        case C_Send_case_3
        by contradiction /* from formulas */
      next
        case C_Send_case_4
        by contradiction /* from formulas */
      next
        case C_Send_case_5
        by contradiction /* from formulas */
      next
        case C_Send_case_6
        by contradiction /* from formulas */
      qed
    next
      case C_RecvReq
      solve( State( ~tid, 'C0', $C, $S, 'client' ) ▶₀ #i )
        case C_0
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_case_01
        by contradiction /* from formulas */
      next
        case C_Recv_case_02
        by contradiction /* from formulas */
      next
        case C_Recv_case_03
        by contradiction /* from formulas */
      next
        case C_Recv_case_04
        by contradiction /* from formulas */
      next
        case C_Recv_case_05
        by contradiction /* from formulas */
      next
        case C_Recv_case_06
        by contradiction /* from formulas */
      next
        case C_Recv_case_07
        by contradiction /* from formulas */
      next
        case C_Recv_case_08
        by contradiction /* from formulas */
      next
        case C_Recv_case_09
        by contradiction /* from formulas */
      next
        case C_Recv_case_10
        by contradiction /* from formulas */
      next
        case C_Request
        by contradiction /* from formulas */
      next
        case C_Send_case_1
        by contradiction /* from formulas */
      next
        case C_Send_case_2
        by contradiction /* from formulas */
      next
        case C_Send_case_3
        by contradiction /* from formulas */
      next
        case C_Send_case_4
        by contradiction /* from formulas */
      next
        case C_Send_case_5
        by contradiction /* from formulas */
      next
        case C_Send_case_6
        by contradiction /* from formulas */
      qed
    next
      case C_Recv_Spontaneous
      solve( State( ~tid, 'C0', $C, $S, 'client' ) ▶₀ #i )
        case C_0
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_case_01
        by contradiction /* from formulas */
      next
        case C_Recv_case_02
        by contradiction /* from formulas */
      next
        case C_Recv_case_03
        by contradiction /* from formulas */
      next
        case C_Recv_case_04
        by contradiction /* from formulas */
      next
        case C_Recv_case_05
        by contradiction /* from formulas */
      next
        case C_Recv_case_06
        by contradiction /* from formulas */
      next
        case C_Recv_case_07
        by contradiction /* from formulas */
      next
        case C_Recv_case_08
        by contradiction /* from formulas */
      next
        case C_Recv_case_09
        by contradiction /* from formulas */
      next
        case C_Recv_case_10
        by contradiction /* from formulas */
      next
        case C_Request
        by contradiction /* from formulas */
      next
        case C_Send_case_1
        by contradiction /* from formulas */
      next
        case C_Send_case_2
        by contradiction /* from formulas */
      next
        case C_Send_case_3
        by contradiction /* from formulas */
      next
        case C_Send_case_4
        by contradiction /* from formulas */
      next
        case C_Send_case_5
        by contradiction /* from formulas */
      next
        case C_Send_case_6
        by contradiction /* from formulas */
      qed
    next
      case C_Request
      solve( State( ~tid, 'C0', $C, $S, 'client' ) ▶₀ #i )
        case C_0
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_case_01
        by contradiction /* from formulas */
      next
        case C_Recv_case_02
        by contradiction /* from formulas */
      next
        case C_Recv_case_03
        by contradiction /* from formulas */
      next
        case C_Recv_case_04
        by contradiction /* from formulas */
      next
        case C_Recv_case_05
        by contradiction /* from formulas */
      next
        case C_Recv_case_06
        by contradiction /* from formulas */
      next
        case C_Recv_case_07
        by contradiction /* from formulas */
      next
        case C_Recv_case_08
        by contradiction /* from formulas */
      next
        case C_Recv_case_09
        by contradiction /* from formulas */
      next
        case C_Recv_case_10
        by contradiction /* from formulas */
      next
        case C_Request
        by contradiction /* from formulas */
      next
        case C_Send_case_1
        by contradiction /* from formulas */
      next
        case C_Send_case_2
        by contradiction /* from formulas */
      next
        case C_Send_case_3
        by contradiction /* from formulas */
      next
        case C_Send_case_4
        by contradiction /* from formulas */
      next
        case C_Send_case_5
        by contradiction /* from formulas */
      next
        case C_Send_case_6
        by contradiction /* from formulas */
      qed
    next
      case C_Send
      solve( State( ~tid, 'C0', $C, $S, 'client' ) ▶₀ #i )
        case C_0
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case C_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case C_Recv_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case C_Recv_case_01
        by contradiction /* from formulas */
      next
        case C_Recv_case_02
        by contradiction /* from formulas */
      next
        case C_Recv_case_03
        by contradiction /* from formulas */
      next
        case C_Recv_case_04
        by contradiction /* from formulas */
      next
        case C_Recv_case_05
        by contradiction /* from formulas */
      next
        case C_Recv_case_06
        by contradiction /* from formulas */
      next
        case C_Recv_case_07
        by contradiction /* from formulas */
      next
        case C_Recv_case_08
        by contradiction /* from formulas */
      next
        case C_Recv_case_09
        by contradiction /* from formulas */
      next
        case C_Recv_case_10
        by contradiction /* from formulas */
      next
        case C_Request
        by contradiction /* from formulas */
      next
        case C_Send_case_1
        by contradiction /* from formulas */
      next
        case C_Send_case_2
        by contradiction /* from formulas */
      next
        case C_Send_case_3
        by contradiction /* from formulas */
      next
        case C_Send_case_4
        by contradiction /* from formulas */
      next
        case C_Send_case_5
        by contradiction /* from formulas */
      next
        case C_Send_case_6
        by contradiction /* from formulas */
      qed
    next
      case S_Recv
      solve( State( ~tid, 'S0', $S, $C, 'server' ) ▶₀ #i )
        case S_0_case_1
        by contradiction /* from formulas */
      next
        case S_0_case_2
        by contradiction /* from formulas */
      next
        case S_0_case_3
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_3
        by contradiction /* from formulas */
      next
        case S_Recv_case_01
        by contradiction /* from formulas */
      next
        case S_Recv_case_02
        by contradiction /* from formulas */
      next
        case S_Recv_case_03
        by contradiction /* from formulas */
      next
        case S_Recv_case_04
        by contradiction /* from formulas */
      next
        case S_Recv_case_05
        by contradiction /* from formulas */
      next
        case S_Recv_case_06
        by contradiction /* from formulas */
      next
        case S_Recv_case_07
        by contradiction /* from formulas */
      next
        case S_Recv_case_08
        by contradiction /* from formulas */
      next
        case S_Recv_case_09
        by contradiction /* from formulas */
      next
        case S_Recv_case_10
        by contradiction /* from formulas */
      next
        case S_Recv_case_11
        by contradiction /* from formulas */
      next
        case S_Recv_case_12
        by contradiction /* from formulas */
      next
        case S_Recv_case_13
        by contradiction /* from formulas */
      next
        case S_Recv_case_14
        by contradiction /* from formulas */
      next
        case S_Recv_case_15
        by contradiction /* from formulas */
      next
        case S_Recv_case_16
        by contradiction /* from formulas */
      next
        case S_Recv_case_17
        by contradiction /* from formulas */
      next
        case S_Recv_case_18
        by contradiction /* from formulas */
      next
        case S_Recv_case_19
        by contradiction /* from formulas */
      next
        case S_Request
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_1
        by contradiction /* from formulas */
      next
        case S_Send_case_2
        by contradiction /* from formulas */
      next
        case S_Send_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_4
        by contradiction /* from formulas */
      next
        case S_Send_case_5
        by contradiction /* from formulas */
      next
        case S_Send_case_6
        by contradiction /* from formulas */
      next
        case S_Send_case_7
        by contradiction /* from formulas */
      next
        case S_Send_case_8
        by contradiction /* from formulas */
      next
        case S_Send_case_9
        by contradiction /* from formulas */
      qed
    next
      case S_RecvReq
      solve( State( ~tid, 'S0', $S, $C, 'server' ) ▶₀ #i )
        case S_0_case_1
        by contradiction /* from formulas */
      next
        case S_0_case_2
        by contradiction /* from formulas */
      next
        case S_0_case_3
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_3
        by contradiction /* from formulas */
      next
        case S_Recv_case_01
        by contradiction /* from formulas */
      next
        case S_Recv_case_02
        by contradiction /* from formulas */
      next
        case S_Recv_case_03
        by contradiction /* from formulas */
      next
        case S_Recv_case_04
        by contradiction /* from formulas */
      next
        case S_Recv_case_05
        by contradiction /* from formulas */
      next
        case S_Recv_case_06
        by contradiction /* from formulas */
      next
        case S_Recv_case_07
        by contradiction /* from formulas */
      next
        case S_Recv_case_08
        by contradiction /* from formulas */
      next
        case S_Recv_case_09
        by contradiction /* from formulas */
      next
        case S_Recv_case_10
        by contradiction /* from formulas */
      next
        case S_Recv_case_11
        by contradiction /* from formulas */
      next
        case S_Recv_case_12
        by contradiction /* from formulas */
      next
        case S_Recv_case_13
        by contradiction /* from formulas */
      next
        case S_Recv_case_14
        by contradiction /* from formulas */
      next
        case S_Recv_case_15
        by contradiction /* from formulas */
      next
        case S_Recv_case_16
        by contradiction /* from formulas */
      next
        case S_Recv_case_17
        by contradiction /* from formulas */
      next
        case S_Recv_case_18
        by contradiction /* from formulas */
      next
        case S_Recv_case_19
        by contradiction /* from formulas */
      next
        case S_Request
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_1
        by contradiction /* from formulas */
      next
        case S_Send_case_2
        by contradiction /* from formulas */
      next
        case S_Send_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_4
        by contradiction /* from formulas */
      next
        case S_Send_case_5
        by contradiction /* from formulas */
      next
        case S_Send_case_6
        by contradiction /* from formulas */
      next
        case S_Send_case_7
        by contradiction /* from formulas */
      next
        case S_Send_case_8
        by contradiction /* from formulas */
      next
        case S_Send_case_9
        by contradiction /* from formulas */
      qed
    next
      case S_Request
      solve( State( ~tid, 'S0', $S, $C, 'server' ) ▶₀ #i )
        case S_0_case_1
        by contradiction /* from formulas */
      next
        case S_0_case_2
        by contradiction /* from formulas */
      next
        case S_0_case_3
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_3
        by contradiction /* from formulas */
      next
        case S_Recv_case_01
        by contradiction /* from formulas */
      next
        case S_Recv_case_02
        by contradiction /* from formulas */
      next
        case S_Recv_case_03
        by contradiction /* from formulas */
      next
        case S_Recv_case_04
        by contradiction /* from formulas */
      next
        case S_Recv_case_05
        by contradiction /* from formulas */
      next
        case S_Recv_case_06
        by contradiction /* from formulas */
      next
        case S_Recv_case_07
        by contradiction /* from formulas */
      next
        case S_Recv_case_08
        by contradiction /* from formulas */
      next
        case S_Recv_case_09
        by contradiction /* from formulas */
      next
        case S_Recv_case_10
        by contradiction /* from formulas */
      next
        case S_Recv_case_11
        by contradiction /* from formulas */
      next
        case S_Recv_case_12
        by contradiction /* from formulas */
      next
        case S_Recv_case_13
        by contradiction /* from formulas */
      next
        case S_Recv_case_14
        by contradiction /* from formulas */
      next
        case S_Recv_case_15
        by contradiction /* from formulas */
      next
        case S_Recv_case_16
        by contradiction /* from formulas */
      next
        case S_Recv_case_17
        by contradiction /* from formulas */
      next
        case S_Recv_case_18
        by contradiction /* from formulas */
      next
        case S_Recv_case_19
        by contradiction /* from formulas */
      next
        case S_Request
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_1
        by contradiction /* from formulas */
      next
        case S_Send_case_2
        by contradiction /* from formulas */
      next
        case S_Send_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_4
        by contradiction /* from formulas */
      next
        case S_Send_case_5
        by contradiction /* from formulas */
      next
        case S_Send_case_6
        by contradiction /* from formulas */
      next
        case S_Send_case_7
        by contradiction /* from formulas */
      next
        case S_Send_case_8
        by contradiction /* from formulas */
      next
        case S_Send_case_9
        by contradiction /* from formulas */
      qed
    next
      case S_Send
      solve( State( ~tid, 'S0', $S, $C, 'server' ) ▶₀ #i )
        case S_0_case_1
        by contradiction /* from formulas */
      next
        case S_0_case_2
        by contradiction /* from formulas */
      next
        case S_0_case_3
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_3
        by contradiction /* from formulas */
      next
        case S_Recv_case_01
        by contradiction /* from formulas */
      next
        case S_Recv_case_02
        by contradiction /* from formulas */
      next
        case S_Recv_case_03
        by contradiction /* from formulas */
      next
        case S_Recv_case_04
        by contradiction /* from formulas */
      next
        case S_Recv_case_05
        by contradiction /* from formulas */
      next
        case S_Recv_case_06
        by contradiction /* from formulas */
      next
        case S_Recv_case_07
        by contradiction /* from formulas */
      next
        case S_Recv_case_08
        by contradiction /* from formulas */
      next
        case S_Recv_case_09
        by contradiction /* from formulas */
      next
        case S_Recv_case_10
        by contradiction /* from formulas */
      next
        case S_Recv_case_11
        by contradiction /* from formulas */
      next
        case S_Recv_case_12
        by contradiction /* from formulas */
      next
        case S_Recv_case_13
        by contradiction /* from formulas */
      next
        case S_Recv_case_14
        by contradiction /* from formulas */
      next
        case S_Recv_case_15
        by contradiction /* from formulas */
      next
        case S_Recv_case_16
        by contradiction /* from formulas */
      next
        case S_Recv_case_17
        by contradiction /* from formulas */
      next
        case S_Recv_case_18
        by contradiction /* from formulas */
      next
        case S_Recv_case_19
        by contradiction /* from formulas */
      next
        case S_Request
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_1
        by contradiction /* from formulas */
      next
        case S_Send_case_2
        by contradiction /* from formulas */
      next
        case S_Send_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_4
        by contradiction /* from formulas */
      next
        case S_Send_case_5
        by contradiction /* from formulas */
      next
        case S_Send_case_6
        by contradiction /* from formulas */
      next
        case S_Send_case_7
        by contradiction /* from formulas */
      next
        case S_Send_case_8
        by contradiction /* from formulas */
      next
        case S_Send_case_9
        by contradiction /* from formulas */
      qed
    next
      case S_Send_Spontaneous
      solve( State( ~tid, 'S0', $S, $C, 'server' ) ▶₀ #i )
        case S_0_case_1
        by contradiction /* from formulas */
      next
        case S_0_case_2
        by contradiction /* from formulas */
      next
        case S_0_case_3
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_1
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_2
        by contradiction /* from formulas */
      next
        case S_RecvReq_case_3
        by contradiction /* from formulas */
      next
        case S_Recv_case_01
        by contradiction /* from formulas */
      next
        case S_Recv_case_02
        by contradiction /* from formulas */
      next
        case S_Recv_case_03
        by contradiction /* from formulas */
      next
        case S_Recv_case_04
        by contradiction /* from formulas */
      next
        case S_Recv_case_05
        by contradiction /* from formulas */
      next
        case S_Recv_case_06
        by contradiction /* from formulas */
      next
        case S_Recv_case_07
        by contradiction /* from formulas */
      next
        case S_Recv_case_08
        by contradiction /* from formulas */
      next
        case S_Recv_case_09
        by contradiction /* from formulas */
      next
        case S_Recv_case_10
        by contradiction /* from formulas */
      next
        case S_Recv_case_11
        by contradiction /* from formulas */
      next
        case S_Recv_case_12
        by contradiction /* from formulas */
      next
        case S_Recv_case_13
        by contradiction /* from formulas */
      next
        case S_Recv_case_14
        by contradiction /* from formulas */
      next
        case S_Recv_case_15
        by contradiction /* from formulas */
      next
        case S_Recv_case_16
        by contradiction /* from formulas */
      next
        case S_Recv_case_17
        by contradiction /* from formulas */
      next
        case S_Recv_case_18
        by contradiction /* from formulas */
      next
        case S_Recv_case_19
        by contradiction /* from formulas */
      next
        case S_Request
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_1
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_2
        by contradiction /* from formulas */
      next
        case S_Send_Spontaneous_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_1
        by contradiction /* from formulas */
      next
        case S_Send_case_2
        by contradiction /* from formulas */
      next
        case S_Send_case_3
        by contradiction /* from formulas */
      next
        case S_Send_case_4
        by contradiction /* from formulas */
      next
        case S_Send_case_5
        by contradiction /* from formulas */
      next
        case S_Send_case_6
        by contradiction /* from formulas */
      next
        case S_Send_case_7
        by contradiction /* from formulas */
      next
        case S_Send_case_8
        by contradiction /* from formulas */
      next
        case S_Send_case_9
        by contradiction /* from formulas */
      qed
    qed
  next
    case case_2
    by contradiction /* from formulas */
  qed
qed

lemma one_start_per_tid [reuse]:
  all-traces
  "∀ tid actor actor2 peer peer2 role role2 #i #j.
    ((Start( tid, actor, peer, role ) @ #i) ∧
     (Start( tid, actor2, peer2, role2 ) @ #j)) ⇒
    (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor actor2 peer peer2 role role2 #i #j.
  (Start( tid, actor, peer, role ) @ #i) ∧
  (Start( tid, actor2, peer2, role2 ) @ #j)
 ∧
  ¬(#i = #j)"
*/
simplify
solve( Start( tid, actor, peer, role ) @ #i )
  case C_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case C_0
    by contradiction /* from formulas */
  next
    case S_0
    by solve( ServerStart( ~tid ) ▶₁ #j )
  qed
next
  case S_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case C_0
    by solve( ServerStart( ~tid ) ▶₁ #i )
  next
    case S_0
    solve( ServerStart( ~tid ) ▶₁ #i )
      case Create_Adv_TLS_channel
      solve( ServerStart( ~tid ) ▶₁ #j )
        case Create_Adv_TLS_channel
        by contradiction /* from formulas */
      qed
    next
      case Create_TLS_channel_bi
      solve( ServerStart( ~tid ) ▶₁ #j )
        case Create_TLS_channel_bi
        by contradiction /* from formulas */
      qed
    next
      case Create_TLS_channel_uni
      solve( ServerStart( ~tid ) ▶₁ #j )
        case Create_TLS_channel_uni
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

lemma exists_Start:
  exists-trace
  "∃ tid actor peer role #j. Start( tid, actor, peer, role ) @ #j"
/*
guarded formula characterizing all satisfying traces:
"∃ tid actor peer role #j. (Start( tid, actor, peer, role ) @ #j)"
*/
simplify
solve( Start( tid, actor, peer, role ) @ #j )
  case C_0
  SOLVED // trace found
next
  case S_0
  solve( ServerStart( ~tid ) ▶₁ #j )
    case Create_Adv_TLS_channel
    solve( !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms
           ) ▶₀ #j )
      case Create_Adv_TLS_channel
      SOLVED // trace found
    qed
  next
    case Create_TLS_channel_bi
    solve( !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms
           ) ▶₀ #j )
      case Create_TLS_channel_bi
      SOLVED // trace found
    qed
  next
    case Create_TLS_channel_uni
    solve( !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms
           ) ▶₀ #j )
      case Create_TLS_channel_uni
      SOLVED // trace found
    qed
  qed
qed

lemma constant_peer:
  all-traces
  "∀ tid actor actor2 peer peer2 role role2 #i #j.
    ((Instance( tid, actor, peer, role ) @ #i) ∧
     (Start( tid, actor2, peer2, role2 ) @ #j)) ⇒
    (((actor = actor2) ∧ (peer = peer2)) ∧ (role = role2))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor actor2 peer peer2 role role2 #i #j.
  (Instance( tid, actor, peer, role ) @ #i) ∧
  (Start( tid, actor2, peer2, role2 ) @ #j)
 ∧
  ((¬(actor = actor2)) ∨ (¬(peer = peer2)) ∨ (¬(role = role2)))"
*/
simplify
solve( Start( tid, actor, peer, role ) @ #j )
  case C_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case C_0
    by contradiction /* from formulas */
  qed
next
  case S_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case S_0
    by contradiction /* from formulas */
  qed
qed

lemma consistent_nonce:
  all-traces
  "∀ tid actor peer role actor2 peer2 role2 #i #j.
    ((Instance( tid, actor, peer, role ) @ #i) ∧
     (Instance( tid, actor2, peer2, role2 ) @ #j)) ⇒
    (((actor = actor2) ∧ (peer = peer2)) ∧ (role = role2))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role actor2 peer2 role2 #i #j.
  (Instance( tid, actor, peer, role ) @ #i) ∧
  (Instance( tid, actor2, peer2, role2 ) @ #j)
 ∧
  ((¬(actor = actor2)) ∨ (¬(peer = peer2)) ∨ (¬(role = role2)))"
*/
simplify
solve( Start( tid, actor, peer, role ) @ #j )
  case C_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case C_0
    by contradiction /* from formulas */
  qed
next
  case S_0
  solve( Start( ~tid, actor2, peer2, role2 ) @ #j )
    case S_0
    by contradiction /* from formulas */
  qed
qed

lemma can_loop_S_Send:
  exists-trace
  "∃ tid #j #k.
    ((S_Send( tid ) @ #j) ∧ (S_Send( tid ) @ #k)) ∧ (#j < #k)"
/*
guarded formula characterizing all satisfying traces:
"∃ tid #j #k.
  (S_Send( tid ) @ #j) ∧ (S_Send( tid ) @ #k) ∧ #j < #k"
*/
by sorry

lemma can_loop_C_Send:
  exists-trace
  "∃ tid #j #k.
    ((C_Send( tid ) @ #j) ∧ (C_Send( tid ) @ #k)) ∧ (#j < #k)"
/*
guarded formula characterizing all satisfying traces:
"∃ tid #j #k.
  (C_Send( tid ) @ #j) ∧ (C_Send( tid ) @ #k) ∧ #j < #k"
*/
by sorry

lemma can_loop_S_Recv:
  exists-trace
  "∃ tid #j #k.
    ((S_Recv( tid ) @ #j) ∧ (S_Recv( tid ) @ #k)) ∧ (#j < #k)"
/*
guarded formula characterizing all satisfying traces:
"∃ tid #j #k.
  (S_Recv( tid ) @ #j) ∧ (S_Recv( tid ) @ #k) ∧ #j < #k"
*/
by sorry

lemma can_loop_C_Recv:
  exists-trace
  "∃ tid #j #k.
    ((C_Recv( tid ) @ #j) ∧ (C_Recv( tid ) @ #k)) ∧ (#j < #k)"
/*
guarded formula characterizing all satisfying traces:
"∃ tid #j #k.
  (C_Recv( tid ) @ #j) ∧ (C_Recv( tid ) @ #k) ∧ #j < #k"
*/
by sorry

lemma reachable_session_keys:
  exists-trace
  "∃ ms transcript #i. SessionKey( ms, transcript ) @ #i"
/*
guarded formula characterizing all satisfying traces:
"∃ ms transcript #i. (SessionKey( ms, transcript ) @ #i)"
*/
simplify
solve( SessionKey( ms, transcript ) @ #i )
  case Create_TLS_channel_bi
  solve( Create_TLS_Channel( owner_host, owner_cid, target_host
         ) ▶₃ #i )
    case C_0
    SOLVED // trace found
  qed
next
  case Create_TLS_channel_uni
  by sorry
qed

lemma secret_session_keys:
  all-traces
  "∀ ms transcript #i.
    (SessionKey( ms, transcript ) @ #i) ⇒
    ((¬(∃ #j. K( ms ) @ #j)) ∧ (¬(∃ #k. K( transcript ) @ #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ ms transcript #i.
  (SessionKey( ms, transcript ) @ #i)
 ∧
  ((∃ #j. (K( ms ) @ #j)) ∨ (∃ #k. (K( transcript ) @ #k)))"
*/
simplify
solve( SessionKey( ms, transcript ) @ #i )
  case Create_TLS_channel_bi
  solve( (∃ #j. (K( ~n ) @ #j))  ∥ (∃ #k. (K( ~n.1 ) @ #k)) )
    case case_1
    solve( !KU( ~n ) @ #vk )
      case Adv_Recv_TLS_case_1
      by solve( TLS_Recv( ~tid, $S.2, $PH,
                          <'13', ~n, $certificate_extensions>
                ) ▶₁ #vr.9 )
    next
      case Adv_Recv_TLS_case_2
      by solve( TLS_Recv( ~tid, $S.1, $PH,
                          <'13', ~n, $certificate_extensions>
                ) ▶₁ #vr.9 )
    next
      case Adv_Recv_TLS_case_3
      solve( TLS_Recv( ~tid, $C.1, $S.2,
                       <'13', ~n, $certificate_extensions>
             ) ▶₁ #vr.9 )
        case Send_TLS_Channel_owner_uni
        by contradiction /* cyclic */
      qed
    next
      case Adv_Recv_TLS_case_4
      solve( TLS_Recv( ~tid, $C.2, $S.2,
                       <'13', ~n, $certificate_extensions>
             ) ▶₁ #vr.9 )
        case Send_TLS_Channel_owner_bi
        by contradiction /* cyclic */
      qed
    next
      case Adv_Recv_TLS_case_5
      solve( TLS_Recv( ~tid, $C.2, $S.2,
                       <'13', ~n, $certificate_extensions>
             ) ▶₁ #vr.9 )
        case Send_TLS_Channel_owner_uni
        by contradiction /* cyclic */
      qed
    qed
  next
    case case_2
    solve( !KU( ~n.1 ) @ #vk )
      case Adv_Recv_TLS_case_1
      by solve( TLS_Recv( ~tid, $S.2, $PH,
                          <'13', ~n.1, $certificate_extensions>
                ) ▶₁ #vr.9 )
    next
      case Adv_Recv_TLS_case_2
      by solve( TLS_Recv( ~tid, $S.1, $PH,
                          <'13', ~n.1, $certificate_extensions>
                ) ▶₁ #vr.9 )
    next
      case Adv_Recv_TLS_case_3
      solve( TLS_Recv( ~tid, $C.1, $S.2,
                       <'13', ~n.1, $certificate_extensions>
             ) ▶₁ #vr.9 )
        case Send_TLS_Channel_owner_uni
        by contradiction /* cyclic */
      qed
    next
      case Adv_Recv_TLS_case_4
      solve( TLS_Recv( ~tid, $C.2, $S.2,
                       <'13', ~n.1, $certificate_extensions>
             ) ▶₁ #vr.9 )
        case Send_TLS_Channel_owner_bi
        by contradiction /* cyclic */
      qed
    next
      case Adv_Recv_TLS_case_5
      solve( TLS_Recv( ~tid, $C.2, $S.2,
                       <'13', ~n.1, $certificate_extensions>
             ) ▶₁ #vr.9 )
        case Send_TLS_Channel_owner_uni
        by contradiction /* cyclic */
      qed
    qed
  qed
next
  case Create_TLS_channel_uni
  solve( Create_TLS_Channel( owner_host, owner_cid, target_host
         ) ▶₃ #i )
    case C_0
    solve( (∃ #j. (K( ~n ) @ #j))  ∥ (∃ #k. (K( ~n.1 ) @ #k)) )
      case case_1
      solve( !KU( ~n ) @ #vk )
        case Adv_Recv_TLS_case_1
        by solve( TLS_Recv( ~tid.1, $S.3, $PH,
                            <'13', ~n, $certificate_extensions>
                  ) ▶₁ #vr.10 )
      next
        case Adv_Recv_TLS_case_2
        by solve( TLS_Recv( ~tid.1, $S.2, $PH,
                            <'13', ~n, $certificate_extensions>
                  ) ▶₁ #vr.10 )
      next
        case Adv_Recv_TLS_case_3
        solve( TLS_Recv( ~tid.1, $C.2, $S.3,
                         <'13', ~n, $certificate_extensions>
               ) ▶₁ #vr.10 )
          case Send_TLS_Channel_owner_uni
          by contradiction /* cyclic */
        qed
      next
        case Adv_Recv_TLS_case_4
        solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                         <'13', ~n, $certificate_extensions>
               ) ▶₁ #vr.10 )
          case Send_TLS_Channel_owner_bi
          by contradiction /* cyclic */
        qed
      next
        case Adv_Recv_TLS_case_5
        solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                         <'13', ~n, $certificate_extensions>
               ) ▶₁ #vr.10 )
          case Send_TLS_Channel_owner_uni
          by contradiction /* cyclic */
        qed
      qed
    next
      case case_2
      solve( !KU( ~n.1 ) @ #vk )
        case Adv_Recv_TLS_case_1
        by solve( TLS_Recv( ~tid.1, $S.3, $PH,
                            <'13', ~n.1, $certificate_extensions>
                  ) ▶₁ #vr.10 )
      next
        case Adv_Recv_TLS_case_2
        by solve( TLS_Recv( ~tid.1, $S.2, $PH,
                            <'13', ~n.1, $certificate_extensions>
                  ) ▶₁ #vr.10 )
      next
        case Adv_Recv_TLS_case_3
        solve( TLS_Recv( ~tid.1, $C.2, $S.3,
                         <'13', ~n.1, $certificate_extensions>
               ) ▶₁ #vr.10 )
          case Send_TLS_Channel_owner_uni
          by contradiction /* cyclic */
        qed
      next
        case Adv_Recv_TLS_case_4
        solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                         <'13', ~n.1, $certificate_extensions>
               ) ▶₁ #vr.10 )
          case Send_TLS_Channel_owner_bi
          by contradiction /* cyclic */
        qed
      next
        case Adv_Recv_TLS_case_5
        solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                         <'13', ~n.1, $certificate_extensions>
               ) ▶₁ #vr.10 )
          case Send_TLS_Channel_owner_uni
          by contradiction /* cyclic */
        qed
      qed
    qed
  qed
qed

lemma cert_ownership:
  all-traces
  "∀ actor ms ltkD del role #k.
    (Recv( actor, ms, role, <del, pk(ltkD)> ) @ #k) ⇒
    ((∃ peer role2 #i.
       ((Owns( peer, ms, role2, <del, ltkD> ) @ #i) ∧ (#i < #k)) ∧
       (¬(role = role2))) ∨
     (∃ #j. (RevLtk( del ) @ #j) ∧ (#j < #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ actor ms ltkD del role #k.
  (Recv( actor, ms, role, <del, pk(ltkD)> ) @ #k)
 ∧
  (∀ peer role2 #i.
    (Owns( peer, ms, role2, <del, ltkD> ) @ #i)
   ⇒
    ((¬(#i < #k)) ∨ (role = role2))) ∧
  (∀ #j. (RevLtk( del ) @ #j) ⇒ ¬(#j < #k))"
*/
simplify
solve( Recv( actor, ms, role, <del, pk(ltkD)> ) @ #k )
  case C_Recv
  solve( Start( ~tid, $C, $S, 'client' ) @ #j )
    case C_0
    solve( !Pk( $A, pk(~ltkA) ) ▶₄ #k )
      case Register_pk
      solve( !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms
             ) ▶₃ #k )
        case Create_TLS_channel_bi
        solve( TLS_Recv( ~tid, $PH, $S,
                         <<'11', certificate_request_context, pk(~ltkA)>, 
                          <'15', 
                           sign(<'ExportedAuthenticator', 
                                 h(<
                                    Expand(Expand(Expand(~ms,
                                                         <'32', 'TLS13exportermastersecret', h(~n)>,
                                                         '32'),
                                                  <'32', 
                                                   'EXPORTER_serverauthenticatorhandshakecontext', 
                                                   'empty'>,
                                                  '32'),
                                           <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                    <'13', certificate_request_context, $certificate_extensions>, 
                                    pk(~ltkA)>)
                                >,
                                ~ltkA)
                          >, 
                          '20', 
                          hmac(<
                                Expand(Expand(Expand(~ms,
                                                     <'32', 'TLS13exportermastersecret', h(~n)>,
                                                     '32'),
                                              <'32', 'EXPORTER_serverauthenticatorfinishedkey', 
                                               'empty'>,
                                              '32'),
                                       <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                Expand(Expand(Expand(~ms,
                                                     <'32', 'TLS13exportermastersecret', h(~n)>,
                                                     '32'),
                                              <'32', 
                                               'EXPORTER_serverauthenticatorhandshakecontext', 
                                               'empty'>,
                                              '32'),
                                       <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                <'13', certificate_request_context, $certificate_extensions>, 
                                <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                sign(<'ExportedAuthenticator', 
                                      h(<
                                         Expand(Expand(Expand(~ms,
                                                              <'32', 'TLS13exportermastersecret', 
                                                               h(~n)>,
                                                              '32'),
                                                       <'32', 
                                                        'EXPORTER_serverauthenticatorhandshakecontext', 
                                                        'empty'>,
                                                       '32'),
                                                <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                         <'13', certificate_request_context, $certificate_extensions
                                         >, 
                                         pk(~ltkA)>)
                                     >,
                                     ~ltkA)
                               >)
                         >
               ) ▶₁ #k )
          case Send_TLS_Channel_target_case_1
          by contradiction /* from formulas */
        next
          case Send_TLS_Channel_target_case_2
          by contradiction /* from formulas */
        next
          case Send_TLS_Channel_target_case_3
          by contradiction /* from formulas */
        qed
      next
        case Create_TLS_channel_uni
        solve( TLS_Recv( ~tid, $PH, $S,
                         <<'11', certificate_request_context, pk(~ltkA)>, 
                          <'15', 
                           sign(<'ExportedAuthenticator', 
                                 h(<
                                    Expand(Expand(Expand(~ms,
                                                         <'32', 'TLS13exportermastersecret', h(~n)>,
                                                         '32'),
                                                  <'32', 
                                                   'EXPORTER_serverauthenticatorhandshakecontext', 
                                                   'empty'>,
                                                  '32'),
                                           <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                    <'13', certificate_request_context, $certificate_extensions>, 
                                    pk(~ltkA)>)
                                >,
                                ~ltkA)
                          >, 
                          '20', 
                          hmac(<
                                Expand(Expand(Expand(~ms,
                                                     <'32', 'TLS13exportermastersecret', h(~n)>,
                                                     '32'),
                                              <'32', 'EXPORTER_serverauthenticatorfinishedkey', 
                                               'empty'>,
                                              '32'),
                                       <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                Expand(Expand(Expand(~ms,
                                                     <'32', 'TLS13exportermastersecret', h(~n)>,
                                                     '32'),
                                              <'32', 
                                               'EXPORTER_serverauthenticatorhandshakecontext', 
                                               'empty'>,
                                              '32'),
                                       <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                <'13', certificate_request_context, $certificate_extensions>, 
                                <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                sign(<'ExportedAuthenticator', 
                                      h(<
                                         Expand(Expand(Expand(~ms,
                                                              <'32', 'TLS13exportermastersecret', 
                                                               h(~n)>,
                                                              '32'),
                                                       <'32', 
                                                        'EXPORTER_serverauthenticatorhandshakecontext', 
                                                        'empty'>,
                                                       '32'),
                                                <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                         <'13', certificate_request_context, $certificate_extensions
                                         >, 
                                         pk(~ltkA)>)
                                     >,
                                     ~ltkA)
                               >)
                         >
               ) ▶₁ #k )
          case Send_TLS_Channel_target_case_1
          by contradiction /* from formulas */
        next
          case Send_TLS_Channel_target_case_2
          by contradiction /* from formulas */
        next
          case Send_TLS_Channel_target_case_3
          by contradiction /* from formulas */
        qed
      qed
    qed
  qed
next
  case C_Recv_Spontaneous
  solve( !Pk( $A, pk(~ltkA) ) ▶₃ #k )
    case Register_pk
    solve( !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms
           ) ▶₂ #k )
      case Create_TLS_channel_bi
      solve( TLS_Recv( ~tid, $PH, $S.1,
                       <<'11', pk(~ltkA)>, 
                        <'15', 
                         sign(<'ExportedAuthenticator', 
                               h(<
                                  Expand(Expand(Expand(~ms,
                                                       <'32', 'TLS13exportermastersecret', h(~n)>,
                                                       '32'),
                                                <'32', 
                                                 'EXPORTER_serverauthenticatorhandshakecontext', 
                                                 'empty'>,
                                                '32'),
                                         <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                  pk(~ltkA)>)
                              >,
                              ~ltkA)
                        >, 
                        '20', 
                        hmac(<
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_serverauthenticatorfinishedkey', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              <'11', pk(~ltkA)>, '15', 
                              sign(<'ExportedAuthenticator', 
                                    h(<
                                       Expand(Expand(Expand(~ms,
                                                            <'32', 'TLS13exportermastersecret', 
                                                             h(~n)>,
                                                            '32'),
                                                     <'32', 
                                                      'EXPORTER_serverauthenticatorhandshakecontext', 
                                                      'empty'>,
                                                     '32'),
                                              <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                       pk(~ltkA)>)
                                   >,
                                   ~ltkA)
                             >)
                       >
             ) ▶₁ #k )
        case Send_TLS_Channel_target
        by contradiction /* from formulas */
      qed
    next
      case Create_TLS_channel_uni
      solve( TLS_Recv( ~tid, $PH, $S.1,
                       <<'11', pk(~ltkA)>, 
                        <'15', 
                         sign(<'ExportedAuthenticator', 
                               h(<
                                  Expand(Expand(Expand(~ms,
                                                       <'32', 'TLS13exportermastersecret', h(~n)>,
                                                       '32'),
                                                <'32', 
                                                 'EXPORTER_serverauthenticatorhandshakecontext', 
                                                 'empty'>,
                                                '32'),
                                         <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                  pk(~ltkA)>)
                              >,
                              ~ltkA)
                        >, 
                        '20', 
                        hmac(<
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_serverauthenticatorfinishedkey', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_serverauthenticatorhandshakecontext', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              <'11', pk(~ltkA)>, '15', 
                              sign(<'ExportedAuthenticator', 
                                    h(<
                                       Expand(Expand(Expand(~ms,
                                                            <'32', 'TLS13exportermastersecret', 
                                                             h(~n)>,
                                                            '32'),
                                                     <'32', 
                                                      'EXPORTER_serverauthenticatorhandshakecontext', 
                                                      'empty'>,
                                                     '32'),
                                              <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                       pk(~ltkA)>)
                                   >,
                                   ~ltkA)
                             >)
                       >
             ) ▶₁ #k )
        case Send_TLS_Channel_target
        by contradiction /* from formulas */
      qed
    qed
  qed
next
  case S_Recv
  solve( !Pk( $A, pk(~ltkA) ) ▶₄ #k )
    case Register_pk
    solve( !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms
           ) ▶₃ #k )
      case Create_Adv_TLS_channel
      solve( TLS_Recv( ~tid, $C, $S,
                       <<'11', certificate_request_context, pk(~ltkA)>, 
                        <'15', 
                         sign(<'ExportedAuthenticator', 
                               h(<
                                  Expand(Expand(Expand(~ms,
                                                       <'32', 'TLS13exportermastersecret', h(~n)>,
                                                       '32'),
                                                <'32', 
                                                 'EXPORTER_clientauthenticatorhandshakecontext', 
                                                 'empty'>,
                                                '32'),
                                         <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                  <'13', certificate_request_context, $certificate_extensions>, 
                                  pk(~ltkA)>)
                              >,
                              ~ltkA)
                        >, 
                        '20', 
                        hmac(<
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_clientauthenticatorfinishedkey', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              <'13', certificate_request_context, $certificate_extensions>, 
                              <'11', certificate_request_context, pk(~ltkA)>, '15', 
                              sign(<'ExportedAuthenticator', 
                                    h(<
                                       Expand(Expand(Expand(~ms,
                                                            <'32', 'TLS13exportermastersecret', 
                                                             h(~n)>,
                                                            '32'),
                                                     <'32', 
                                                      'EXPORTER_clientauthenticatorhandshakecontext', 
                                                      'empty'>,
                                                     '32'),
                                              <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                       <'13', certificate_request_context, $certificate_extensions
                                       >, 
                                       pk(~ltkA)>)
                                   >,
                                   ~ltkA)
                             >)
                       >
             ) ▶₁ #k )
        case Send_TLS_Channel_owner_uni
        solve( !KU( sign(<'ExportedAuthenticator', 
                          h(<
                             Expand(Expand(Expand(~ms,
                                                  <'32', 'TLS13exportermastersecret', h(~n)>, '32'),
                                           <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 
                                            'empty'>,
                                           '32'),
                                    <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                             <'13', certificate_request_context, $certificate_extensions>, 
                             pk(~ltkA)>)
                         >,
                         ~ltkA)
               ) @ #vk.11 )
          case c_sign
          solve( !KU( ~ltkA ) @ #vk.16 )
            case Adv_Recv_TLS_case_1
            by solve( TLS_Recv( ~tid.1, $S.3, $PH,
                                <'13', ~ltkA, $certificate_extensions.1>
                      ) ▶₁ #vr.13 )
          next
            case Adv_Recv_TLS_case_2
            by solve( TLS_Recv( ~tid.1, $S.2, $PH,
                                <'13', ~ltkA, $certificate_extensions.1>
                      ) ▶₁ #vr.13 )
          next
            case Adv_Recv_TLS_case_3
            solve( TLS_Recv( ~tid.1, $C.2, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.13 )
              case Send_TLS_Channel_owner_uni
              by contradiction /* cyclic */
            qed
          next
            case Adv_Recv_TLS_case_4
            solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.13 )
              case Send_TLS_Channel_owner_bi
              by contradiction /* cyclic */
            qed
          next
            case Adv_Recv_TLS_case_5
            solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.13 )
              case Send_TLS_Channel_owner_uni
              by contradiction /* cyclic */
            qed
          next
            case Reveal_ltk
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case Create_TLS_channel_bi
      solve( TLS_Recv( ~tid, $C, $S,
                       <<'11', certificate_request_context, pk(~ltkA)>, 
                        <'15', 
                         sign(<'ExportedAuthenticator', 
                               h(<
                                  Expand(Expand(Expand(~ms,
                                                       <'32', 'TLS13exportermastersecret', h(~n)>,
                                                       '32'),
                                                <'32', 
                                                 'EXPORTER_clientauthenticatorhandshakecontext', 
                                                 'empty'>,
                                                '32'),
                                         <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                  <'13', certificate_request_context, $certificate_extensions>, 
                                  pk(~ltkA)>)
                              >,
                              ~ltkA)
                        >, 
                        '20', 
                        hmac(<
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_clientauthenticatorfinishedkey', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              <'13', certificate_request_context, $certificate_extensions>, 
                              <'11', certificate_request_context, pk(~ltkA)>, '15', 
                              sign(<'ExportedAuthenticator', 
                                    h(<
                                       Expand(Expand(Expand(~ms,
                                                            <'32', 'TLS13exportermastersecret', 
                                                             h(~n)>,
                                                            '32'),
                                                     <'32', 
                                                      'EXPORTER_clientauthenticatorhandshakecontext', 
                                                      'empty'>,
                                                     '32'),
                                              <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                       <'13', certificate_request_context, $certificate_extensions
                                       >, 
                                       pk(~ltkA)>)
                                   >,
                                   ~ltkA)
                             >)
                       >
             ) ▶₁ #k )
        case Send_TLS_Channel_owner_bi_case_1
        solve( !KU( sign(<'ExportedAuthenticator', 
                          h(<
                             Expand(Expand(Expand(~ms,
                                                  <'32', 'TLS13exportermastersecret', h(~n)>, '32'),
                                           <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 
                                            'empty'>,
                                           '32'),
                                    <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                             <'13', certificate_request_context, $certificate_extensions>, 
                             pk(~ltkA)>)
                         >,
                         ~ltkA)
               ) @ #vk.11 )
          case Adv_Recv_TLS_case_1
          by contradiction /* from formulas */
        next
          case Adv_Recv_TLS_case_2
          by contradiction /* from formulas */
        next
          case Adv_Recv_TLS_case_3
          by contradiction /* from formulas */
        next
          case c_sign
          solve( !KU( ~ltkA ) @ #vk.16 )
            case Adv_Recv_TLS_case_1
            by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                <'13', ~ltkA, $certificate_extensions.1>
                      ) ▶₁ #vr.14 )
          next
            case Adv_Recv_TLS_case_2
            by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                <'13', ~ltkA, $certificate_extensions.1>
                      ) ▶₁ #vr.14 )
          next
            case Adv_Recv_TLS_case_3
            solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.14 )
              case Send_TLS_Channel_owner_uni
              by contradiction /* cyclic */
            qed
          next
            case Adv_Recv_TLS_case_4
            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.14 )
              case Send_TLS_Channel_owner_bi
              by contradiction /* cyclic */
            qed
          next
            case Adv_Recv_TLS_case_5
            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.14 )
              case Send_TLS_Channel_owner_uni
              by contradiction /* cyclic */
            qed
          next
            case Reveal_ltk
            by contradiction /* from formulas */
          qed
        qed
      next
        case Send_TLS_Channel_owner_bi_case_2
        by contradiction /* from formulas */
      next
        case Send_TLS_Channel_owner_bi_case_3
        by contradiction /* from formulas */
      next
        case Send_TLS_Channel_owner_bi_case_4
        by contradiction /* from formulas */
      qed
    next
      case Create_TLS_channel_uni
      solve( TLS_Recv( ~tid, $C, $S,
                       <<'11', certificate_request_context, pk(~ltkA)>, 
                        <'15', 
                         sign(<'ExportedAuthenticator', 
                               h(<
                                  Expand(Expand(Expand(~ms,
                                                       <'32', 'TLS13exportermastersecret', h(~n)>,
                                                       '32'),
                                                <'32', 
                                                 'EXPORTER_clientauthenticatorhandshakecontext', 
                                                 'empty'>,
                                                '32'),
                                         <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                  <'13', certificate_request_context, $certificate_extensions>, 
                                  pk(~ltkA)>)
                              >,
                              ~ltkA)
                        >, 
                        '20', 
                        hmac(<
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_clientauthenticatorfinishedkey', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              Expand(Expand(Expand(~ms,
                                                   <'32', 'TLS13exportermastersecret', h(~n)>,
                                                   '32'),
                                            <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 
                                             'empty'>,
                                            '32'),
                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                              <'13', certificate_request_context, $certificate_extensions>, 
                              <'11', certificate_request_context, pk(~ltkA)>, '15', 
                              sign(<'ExportedAuthenticator', 
                                    h(<
                                       Expand(Expand(Expand(~ms,
                                                            <'32', 'TLS13exportermastersecret', 
                                                             h(~n)>,
                                                            '32'),
                                                     <'32', 
                                                      'EXPORTER_clientauthenticatorhandshakecontext', 
                                                      'empty'>,
                                                     '32'),
                                              <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                       <'13', certificate_request_context, $certificate_extensions
                                       >, 
                                       pk(~ltkA)>)
                                   >,
                                   ~ltkA)
                             >)
                       >
             ) ▶₁ #k )
        case Send_TLS_Channel_owner_uni_case_1
        solve( !KU( sign(<'ExportedAuthenticator', 
                          h(<
                             Expand(Expand(Expand(~ms,
                                                  <'32', 'TLS13exportermastersecret', h(~n)>, '32'),
                                           <'32', 'EXPORTER_clientauthenticatorhandshakecontext', 
                                            'empty'>,
                                           '32'),
                                    <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                             <'13', certificate_request_context, $certificate_extensions>, 
                             pk(~ltkA)>)
                         >,
                         ~ltkA)
               ) @ #vk.11 )
          case Adv_Recv_TLS_case_1
          by contradiction /* from formulas */
        next
          case Adv_Recv_TLS_case_2
          by contradiction /* from formulas */
        next
          case Adv_Recv_TLS_case_3
          by contradiction /* from formulas */
        next
          case c_sign
          solve( !KU( ~ltkA ) @ #vk.16 )
            case Adv_Recv_TLS_case_1
            by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                <'13', ~ltkA, $certificate_extensions.1>
                      ) ▶₁ #vr.14 )
          next
            case Adv_Recv_TLS_case_2
            by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                <'13', ~ltkA, $certificate_extensions.1>
                      ) ▶₁ #vr.14 )
          next
            case Adv_Recv_TLS_case_3
            solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.14 )
              case Send_TLS_Channel_owner_uni
              by contradiction /* cyclic */
            qed
          next
            case Adv_Recv_TLS_case_4
            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.14 )
              case Send_TLS_Channel_owner_bi
              by contradiction /* cyclic */
            qed
          next
            case Adv_Recv_TLS_case_5
            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                             <'13', ~ltkA, $certificate_extensions.1>
                   ) ▶₁ #vr.14 )
              case Send_TLS_Channel_owner_uni
              by contradiction /* cyclic */
            qed
          next
            case Reveal_ltk
            by contradiction /* from formulas */
          qed
        qed
      next
        case Send_TLS_Channel_owner_uni_case_2
        by contradiction /* from formulas */
      next
        case Send_TLS_Channel_owner_uni_case_3
        by contradiction /* from formulas */
      next
        case Send_TLS_Channel_owner_uni_case_4
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

lemma cert_linking:
  all-traces
  "∀ actor ms role ltkD del ltkD2 del2 #j #k.
    ((Recv( actor, ms, role, <del, pk(ltkD)> ) @ #j) ∧
     (Recv( actor, ms, role, <del2, pk(ltkD2)> ) @ #k)) ⇒
    (((∃ peer role2 #h #i.
        ((((Owns( peer, ms, role2, <del, ltkD> ) @ #h) ∧ (#h < #j)) ∧
          (Owns( peer, ms, role2, <del2, ltkD2> ) @ #i)) ∧
         (#i < #k)) ∧
        (¬(role = role2))) ∨
      (∃ #l. (RevLtk( del ) @ #l) ∧ (#l < #k))) ∨
     (∃ #l. (RevLtk( del2 ) @ #l) ∧ (#l < #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ actor ms role ltkD del ltkD2 del2 #j #k.
  (Recv( actor, ms, role, <del, pk(ltkD)> ) @ #j) ∧
  (Recv( actor, ms, role, <del2, pk(ltkD2)> ) @ #k)
 ∧
  (∀ peer role2 #h #i.
    (Owns( peer, ms, role2, <del, ltkD> ) @ #h) ∧
    (Owns( peer, ms, role2, <del2, ltkD2> ) @ #i)
   ⇒
    ((¬(#h < #j)) ∨ (¬(#i < #k)) ∨ (role = role2))) ∧
  (∀ #l. (RevLtk( del ) @ #l) ⇒ ¬(#l < #k)) ∧
  (∀ #l. (RevLtk( del2 ) @ #l) ⇒ ¬(#l < #k))"
*/
simplify
solve( Recv( actor, ms, role, <del, pk(ltkD)> ) @ #j )
  case C_Recv
  solve( Start( ~tid, $C, $S, 'client' ) @ #j.1 )
    case C_0
    solve( !Pk( $A, pk(~ltkA) ) ▶₄ #j )
      case Register_pk
      solve( Recv( $C, ~ms, 'client', <del2, pk(ltkD2)> ) @ #k )
        case C_Recv
        solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₄ #k )
          case Register_pk
          solve( Start( ~tid.1, $C, $S.1, 'client' ) @ #j.2 )
            case C_0
            solve( !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms
                   ) ▶₃ #j )
              case Create_TLS_channel_bi
              solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                     ) ▶₃ #k )
                case Create_TLS_channel_bi
                solve( TLS_Recv( ~tid, $PH, $S,
                                 <<'11', certificate_request_context, pk(~ltkA)>, 
                                  <'15', 
                                   sign(<'ExportedAuthenticator', 
                                         h(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context, 
                                             $certificate_extensions>, 
                                            pk(~ltkA)>)
                                        >,
                                        ~ltkA)
                                  >, 
                                  '20', 
                                  hmac(<
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorfinishedkey', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorhandshakecontext', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        <'13', certificate_request_context, $certificate_extensions
                                        >, 
                                        <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                        sign(<'ExportedAuthenticator', 
                                              h(<
                                                 Expand(Expand(Expand(~ms,
                                                                      <'32', 
                                                                       'TLS13exportermastersecret', 
                                                                       h(~n)>,
                                                                      '32'),
                                                               <'32', 
                                                                'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                'empty'>,
                                                               '32'),
                                                        <'32', 'exporter', h(<'empty', '32'>)>,
                                                        '32'), 
                                                 <'13', certificate_request_context, 
                                                  $certificate_extensions>, 
                                                 pk(~ltkA)>)
                                             >,
                                             ~ltkA)
                                       >)
                                 >
                       ) ▶₁ #j )
                  case Send_TLS_Channel_target_case_1
                  solve( Start( ~n.1, $S, $PH, 'server' ) @ #j.2 )
                    case S_0
                    by solve( Start( ~n.1, $C.1, $S.1, 'client' ) @ #j.2 )
                  qed
                next
                  case Send_TLS_Channel_target_case_2
                  solve( Start( ~n.1, $S, $PH, 'server' ) @ #j.2 )
                    case S_0
                    solve( Start( ~n.1, $S.1, $C.1, 'server' ) @ #j.2 )
                      case S_0
                      solve( TLS_Recv( ~tid, $PH.1, $S,
                                       <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                        <'15', 
                                         sign(<'ExportedAuthenticator', 
                                               h(<
                                                  Expand(Expand(Expand(~ms,
                                                                       <'32', 
                                                                        'TLS13exportermastersecret', 
                                                                        h(~n)>,
                                                                       '32'),
                                                                <'32', 
                                                                 'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                 'empty'>,
                                                                '32'),
                                                         <'32', 'exporter', h(<'empty', '32'>)>,
                                                         '32'), 
                                                  <'13', certificate_request_context.1, 
                                                   $certificate_extensions.1>, 
                                                  pk(~ltkA.1)>)
                                              >,
                                              ~ltkA.1)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorfinishedkey', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context.1, 
                                               $certificate_extensions.1>, 
                                              <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                              '15', 
                                              sign(<'ExportedAuthenticator', 
                                                    h(<
                                                       Expand(Expand(Expand(~ms,
                                                                            <'32', 
                                                                             'TLS13exportermastersecret', 
                                                                             h(~n)>,
                                                                            '32'),
                                                                     <'32', 
                                                                      'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                      'empty'>,
                                                                     '32'),
                                                              <'32', 'exporter', h(<'empty', '32'>)
                                                              >,
                                                              '32'), 
                                                       <'13', certificate_request_context.1, 
                                                        $certificate_extensions.1>, 
                                                       pk(~ltkA.1)>)
                                                   >,
                                                   ~ltkA.1)
                                             >)
                                       >
                             ) ▶₁ #k )
                        case Send_TLS_Channel_target_case_1
                        by contradiction /* from formulas */
                      next
                        case Send_TLS_Channel_target_case_2
                        by contradiction /* from formulas */
                      next
                        case Send_TLS_Channel_target_case_3
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case Send_TLS_Channel_target_case_3
                  solve( Start( ~n.1, $S.1, $C.1, 'server' ) @ #j.2 )
                    case S_0
                    solve( TLS_Recv( ~tid, $PH.1, $S,
                                     <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                      <'15', 
                                       sign(<'ExportedAuthenticator', 
                                             h(<
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_serverauthenticatorhandshakecontext', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                <'13', certificate_request_context.1, 
                                                 $certificate_extensions.1>, 
                                                pk(~ltkA.1)>)
                                            >,
                                            ~ltkA.1)
                                      >, 
                                      '20', 
                                      hmac(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorfinishedkey', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context.1, 
                                             $certificate_extensions.1>, 
                                            <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                            '15', 
                                            sign(<'ExportedAuthenticator', 
                                                  h(<
                                                     Expand(Expand(Expand(~ms,
                                                                          <'32', 
                                                                           'TLS13exportermastersecret', 
                                                                           h(~n)>,
                                                                          '32'),
                                                                   <'32', 
                                                                    'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                    'empty'>,
                                                                   '32'),
                                                            <'32', 'exporter', h(<'empty', '32'>)>,
                                                            '32'), 
                                                     <'13', certificate_request_context.1, 
                                                      $certificate_extensions.1>, 
                                                     pk(~ltkA.1)>)
                                                 >,
                                                 ~ltkA.1)
                                           >)
                                     >
                           ) ▶₁ #k )
                      case Send_TLS_Channel_target_case_1
                      by contradiction /* from formulas */
                    next
                      case Send_TLS_Channel_target_case_2
                      by contradiction /* from formulas */
                    next
                      case Send_TLS_Channel_target_case_3
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            next
              case Create_TLS_channel_uni
              solve( TLS_Recv( ~tid, $PH, $S,
                               <<'11', certificate_request_context, pk(~ltkA)>, 
                                <'15', 
                                 sign(<'ExportedAuthenticator', 
                                       h(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'13', certificate_request_context, 
                                           $certificate_extensions>, 
                                          pk(~ltkA)>)
                                      >,
                                      ~ltkA)
                                >, 
                                '20', 
                                hmac(<
                                      Expand(Expand(Expand(~ms,
                                                           <'32', 'TLS13exportermastersecret', h(~n)
                                                           >,
                                                           '32'),
                                                    <'32', 
                                                     'EXPORTER_serverauthenticatorfinishedkey', 
                                                     'empty'>,
                                                    '32'),
                                             <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                      Expand(Expand(Expand(~ms,
                                                           <'32', 'TLS13exportermastersecret', h(~n)
                                                           >,
                                                           '32'),
                                                    <'32', 
                                                     'EXPORTER_serverauthenticatorhandshakecontext', 
                                                     'empty'>,
                                                    '32'),
                                             <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                      <'13', certificate_request_context, $certificate_extensions>, 
                                      <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                      sign(<'ExportedAuthenticator', 
                                            h(<
                                               Expand(Expand(Expand(~ms,
                                                                    <'32', 
                                                                     'TLS13exportermastersecret', 
                                                                     h(~n)>,
                                                                    '32'),
                                                             <'32', 
                                                              'EXPORTER_serverauthenticatorhandshakecontext', 
                                                              'empty'>,
                                                             '32'),
                                                      <'32', 'exporter', h(<'empty', '32'>)>,
                                                      '32'), 
                                               <'13', certificate_request_context, 
                                                $certificate_extensions>, 
                                               pk(~ltkA)>)
                                           >,
                                           ~ltkA)
                                     >)
                               >
                     ) ▶₁ #j )
                case Send_TLS_Channel_target_case_1
                by solve( Start( ~n.1, $C.1, $S.2, 'client' ) @ #j.3 )
              next
                case Send_TLS_Channel_target_case_2
                solve( Start( ~n.1, $S.2, $C.1, 'server' ) @ #j.3 )
                  case S_0
                  solve( Start( ~n.1, $S, $PH, 'server' ) @ #j.3 )
                    case S_0
                    solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                           ) ▶₃ #k )
                      case Create_TLS_channel_uni
                      solve( TLS_Recv( ~tid, $PH.1, $S,
                                       <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                        <'15', 
                                         sign(<'ExportedAuthenticator', 
                                               h(<
                                                  Expand(Expand(Expand(~ms,
                                                                       <'32', 
                                                                        'TLS13exportermastersecret', 
                                                                        h(~n)>,
                                                                       '32'),
                                                                <'32', 
                                                                 'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                 'empty'>,
                                                                '32'),
                                                         <'32', 'exporter', h(<'empty', '32'>)>,
                                                         '32'), 
                                                  <'13', certificate_request_context.1, 
                                                   $certificate_extensions.1>, 
                                                  pk(~ltkA.1)>)
                                              >,
                                              ~ltkA.1)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorfinishedkey', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context.1, 
                                               $certificate_extensions.1>, 
                                              <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                              '15', 
                                              sign(<'ExportedAuthenticator', 
                                                    h(<
                                                       Expand(Expand(Expand(~ms,
                                                                            <'32', 
                                                                             'TLS13exportermastersecret', 
                                                                             h(~n)>,
                                                                            '32'),
                                                                     <'32', 
                                                                      'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                      'empty'>,
                                                                     '32'),
                                                              <'32', 'exporter', h(<'empty', '32'>)
                                                              >,
                                                              '32'), 
                                                       <'13', certificate_request_context.1, 
                                                        $certificate_extensions.1>, 
                                                       pk(~ltkA.1)>)
                                                   >,
                                                   ~ltkA.1)
                                             >)
                                       >
                             ) ▶₁ #k )
                        case Send_TLS_Channel_target_case_1
                        by contradiction /* from formulas */
                      next
                        case Send_TLS_Channel_target_case_2
                        by contradiction /* from formulas */
                      next
                        case Send_TLS_Channel_target_case_3
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              next
                case Send_TLS_Channel_target_case_3
                solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                       ) ▶₃ #k )
                  case Create_TLS_channel_uni
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context.1, 
                                               $certificate_extensions.1>, 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'13', certificate_request_context.1, 
                                           $certificate_extensions.1>, 
                                          <'11', certificate_request_context.1, pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   <'13', certificate_request_context.1, 
                                                    $certificate_extensions.1>, 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target_case_1
                    by contradiction /* from formulas */
                  next
                    case Send_TLS_Channel_target_case_2
                    by contradiction /* from formulas */
                  next
                    case Send_TLS_Channel_target_case_3
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case C_Recv_Spontaneous
        solve( Start( ~tid.1, $C, $S.1, 'client' ) @ #j.2 )
          case C_0
          solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₃ #k )
            case Register_pk
            solve( !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms
                   ) ▶₃ #j )
              case Create_TLS_channel_bi
              solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                     ) ▶₂ #k )
                case Create_TLS_channel_bi
                solve( TLS_Recv( ~tid, $PH, $S,
                                 <<'11', certificate_request_context, pk(~ltkA)>, 
                                  <'15', 
                                   sign(<'ExportedAuthenticator', 
                                         h(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context, 
                                             $certificate_extensions>, 
                                            pk(~ltkA)>)
                                        >,
                                        ~ltkA)
                                  >, 
                                  '20', 
                                  hmac(<
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorfinishedkey', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorhandshakecontext', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        <'13', certificate_request_context, $certificate_extensions
                                        >, 
                                        <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                        sign(<'ExportedAuthenticator', 
                                              h(<
                                                 Expand(Expand(Expand(~ms,
                                                                      <'32', 
                                                                       'TLS13exportermastersecret', 
                                                                       h(~n)>,
                                                                      '32'),
                                                               <'32', 
                                                                'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                'empty'>,
                                                               '32'),
                                                        <'32', 'exporter', h(<'empty', '32'>)>,
                                                        '32'), 
                                                 <'13', certificate_request_context, 
                                                  $certificate_extensions>, 
                                                 pk(~ltkA)>)
                                             >,
                                             ~ltkA)
                                       >)
                                 >
                       ) ▶₁ #j )
                  case Send_TLS_Channel_target_case_1
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'11', pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target
                    by contradiction /* from formulas */
                  qed
                next
                  case Send_TLS_Channel_target_case_2
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'11', pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target
                    by contradiction /* from formulas */
                  qed
                next
                  case Send_TLS_Channel_target_case_3
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'11', pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            next
              case Create_TLS_channel_uni
              solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                     ) ▶₂ #k )
                case Create_TLS_channel_uni
                solve( TLS_Recv( ~tid, $PH, $S,
                                 <<'11', certificate_request_context, pk(~ltkA)>, 
                                  <'15', 
                                   sign(<'ExportedAuthenticator', 
                                         h(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context, 
                                             $certificate_extensions>, 
                                            pk(~ltkA)>)
                                        >,
                                        ~ltkA)
                                  >, 
                                  '20', 
                                  hmac(<
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorfinishedkey', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorhandshakecontext', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        <'13', certificate_request_context, $certificate_extensions
                                        >, 
                                        <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                        sign(<'ExportedAuthenticator', 
                                              h(<
                                                 Expand(Expand(Expand(~ms,
                                                                      <'32', 
                                                                       'TLS13exportermastersecret', 
                                                                       h(~n)>,
                                                                      '32'),
                                                               <'32', 
                                                                'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                'empty'>,
                                                               '32'),
                                                        <'32', 'exporter', h(<'empty', '32'>)>,
                                                        '32'), 
                                                 <'13', certificate_request_context, 
                                                  $certificate_extensions>, 
                                                 pk(~ltkA)>)
                                             >,
                                             ~ltkA)
                                       >)
                                 >
                       ) ▶₁ #j )
                  case Send_TLS_Channel_target_case_1
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'11', pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target
                    by contradiction /* from formulas */
                  qed
                next
                  case Send_TLS_Channel_target_case_2
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'11', pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target
                    by contradiction /* from formulas */
                  qed
                next
                  case Send_TLS_Channel_target_case_3
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'11', pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case C_Recv_Spontaneous
  solve( Start( ~tid, $C, $S, 'client' ) @ #j.1 )
    case C_0
    solve( !Pk( $A, pk(~ltkA) ) ▶₃ #j )
      case Register_pk
      solve( !Exporters( ~ms, 'client', ~tid, hccc, hccs, fmc, fms
             ) ▶₂ #j )
        case Create_TLS_channel_bi
        solve( Recv( $C, ~ms, 'client', <del2, pk(ltkD2)> ) @ #k )
          case C_Recv
          solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                 ) ▶₃ #k )
            case Create_TLS_channel_bi
            solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₄ #k )
              case Register_pk
              solve( Start( ~tid, $C, $S.1, 'client' ) @ #j.1 )
                case C_0
                solve( TLS_Recv( ~tid, $PH, $S,
                                 <<'11', pk(~ltkA)>, 
                                  <'15', 
                                   sign(<'ExportedAuthenticator', 
                                         h(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            pk(~ltkA)>)
                                        >,
                                        ~ltkA)
                                  >, 
                                  '20', 
                                  hmac(<
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorfinishedkey', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorhandshakecontext', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        <'11', pk(~ltkA)>, '15', 
                                        sign(<'ExportedAuthenticator', 
                                              h(<
                                                 Expand(Expand(Expand(~ms,
                                                                      <'32', 
                                                                       'TLS13exportermastersecret', 
                                                                       h(~n)>,
                                                                      '32'),
                                                               <'32', 
                                                                'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                'empty'>,
                                                               '32'),
                                                        <'32', 'exporter', h(<'empty', '32'>)>,
                                                        '32'), 
                                                 pk(~ltkA)>)
                                             >,
                                             ~ltkA)
                                       >)
                                 >
                       ) ▶₁ #j )
                  case Send_TLS_Channel_target
                  solve( TLS_Recv( ~tid, $PH.1, $S,
                                   <<'11', certificate_request_context, pk(~ltkA.1)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context, 
                                               $certificate_extensions>, 
                                              pk(~ltkA.1)>)
                                          >,
                                          ~ltkA.1)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'13', certificate_request_context, 
                                           $certificate_extensions>, 
                                          <'11', certificate_request_context, pk(~ltkA.1)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   <'13', certificate_request_context, 
                                                    $certificate_extensions>, 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                         >)
                                   >
                         ) ▶₁ #k )
                    case Send_TLS_Channel_target_case_1
                    by contradiction /* from formulas */
                  next
                    case Send_TLS_Channel_target_case_2
                    by contradiction /* from formulas */
                  next
                    case Send_TLS_Channel_target_case_3
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        next
          case C_Recv_Spontaneous
          solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₃ #k )
            case Register_pk
            solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                   ) ▶₂ #k )
              case Create_TLS_channel_bi
              solve( TLS_Recv( ~tid, $PH, $S,
                               <<'11', pk(~ltkA)>, 
                                <'15', 
                                 sign(<'ExportedAuthenticator', 
                                       h(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_serverauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          pk(~ltkA)>)
                                      >,
                                      ~ltkA)
                                >, 
                                '20', 
                                hmac(<
                                      Expand(Expand(Expand(~ms,
                                                           <'32', 'TLS13exportermastersecret', h(~n)
                                                           >,
                                                           '32'),
                                                    <'32', 
                                                     'EXPORTER_serverauthenticatorfinishedkey', 
                                                     'empty'>,
                                                    '32'),
                                             <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                      Expand(Expand(Expand(~ms,
                                                           <'32', 'TLS13exportermastersecret', h(~n)
                                                           >,
                                                           '32'),
                                                    <'32', 
                                                     'EXPORTER_serverauthenticatorhandshakecontext', 
                                                     'empty'>,
                                                    '32'),
                                             <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                      <'11', pk(~ltkA)>, '15', 
                                      sign(<'ExportedAuthenticator', 
                                            h(<
                                               Expand(Expand(Expand(~ms,
                                                                    <'32', 
                                                                     'TLS13exportermastersecret', 
                                                                     h(~n)>,
                                                                    '32'),
                                                             <'32', 
                                                              'EXPORTER_serverauthenticatorhandshakecontext', 
                                                              'empty'>,
                                                             '32'),
                                                      <'32', 'exporter', h(<'empty', '32'>)>,
                                                      '32'), 
                                               pk(~ltkA)>)
                                           >,
                                           ~ltkA)
                                     >)
                               >
                     ) ▶₁ #j )
                case Send_TLS_Channel_target
                solve( TLS_Recv( ~tid, $PH.1, $S.1,
                                 <<'11', pk(~ltkA.1)>, 
                                  <'15', 
                                   sign(<'ExportedAuthenticator', 
                                         h(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_serverauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            pk(~ltkA.1)>)
                                        >,
                                        ~ltkA.1)
                                  >, 
                                  '20', 
                                  hmac(<
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorfinishedkey', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        Expand(Expand(Expand(~ms,
                                                             <'32', 'TLS13exportermastersecret', 
                                                              h(~n)>,
                                                             '32'),
                                                      <'32', 
                                                       'EXPORTER_serverauthenticatorhandshakecontext', 
                                                       'empty'>,
                                                      '32'),
                                               <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                        <'11', pk(~ltkA.1)>, '15', 
                                        sign(<'ExportedAuthenticator', 
                                              h(<
                                                 Expand(Expand(Expand(~ms,
                                                                      <'32', 
                                                                       'TLS13exportermastersecret', 
                                                                       h(~n)>,
                                                                      '32'),
                                                               <'32', 
                                                                'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                'empty'>,
                                                               '32'),
                                                        <'32', 'exporter', h(<'empty', '32'>)>,
                                                        '32'), 
                                                 pk(~ltkA.1)>)
                                             >,
                                             ~ltkA.1)
                                       >)
                                 >
                       ) ▶₁ #k )
                  case Send_TLS_Channel_target
                  solve( Start( ~n.1, $S, $PH, 'server' ) @ #j.2 )
                    case S_0
                    solve( Start( ~tid, $C, $TP, 'client' ) @ #j.1 )
                      case C_0
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case Create_TLS_channel_uni
        solve( TLS_Recv( ~tid, $PH, $S,
                         <<'11', pk(~ltkA)>, 
                          <'15', 
                           sign(<'ExportedAuthenticator', 
                                 h(<
                                    Expand(Expand(Expand(~ms,
                                                         <'32', 'TLS13exportermastersecret', h(~n)>,
                                                         '32'),
                                                  <'32', 
                                                   'EXPORTER_serverauthenticatorhandshakecontext', 
                                                   'empty'>,
                                                  '32'),
                                           <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                    pk(~ltkA)>)
                                >,
                                ~ltkA)
                          >, 
                          '20', 
                          hmac(<
                                Expand(Expand(Expand(~ms,
                                                     <'32', 'TLS13exportermastersecret', h(~n)>,
                                                     '32'),
                                              <'32', 'EXPORTER_serverauthenticatorfinishedkey', 
                                               'empty'>,
                                              '32'),
                                       <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                Expand(Expand(Expand(~ms,
                                                     <'32', 'TLS13exportermastersecret', h(~n)>,
                                                     '32'),
                                              <'32', 
                                               'EXPORTER_serverauthenticatorhandshakecontext', 
                                               'empty'>,
                                              '32'),
                                       <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                <'11', pk(~ltkA)>, '15', 
                                sign(<'ExportedAuthenticator', 
                                      h(<
                                         Expand(Expand(Expand(~ms,
                                                              <'32', 'TLS13exportermastersecret', 
                                                               h(~n)>,
                                                              '32'),
                                                       <'32', 
                                                        'EXPORTER_serverauthenticatorhandshakecontext', 
                                                        'empty'>,
                                                       '32'),
                                                <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                         pk(~ltkA)>)
                                     >,
                                     ~ltkA)
                               >)
                         >
               ) ▶₁ #j )
          case Send_TLS_Channel_target
          solve( Start( ~n.1, $S, $PH, 'server' ) @ #j.2 )
            case S_0
            solve( !Exporters( ~ms.1, 'server', ~n.1, hccc, hccs, fmc, fms
                   ) ▶₀ #j.2 )
              case Create_TLS_channel_uni
              solve( Recv( $C, ~ms, 'client', <del2, pk(ltkD2)> ) @ #k )
                case C_Recv
                solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₄ #k )
                  case Register_pk
                  solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                         ) ▶₃ #k )
                    case Create_TLS_channel_uni
                    solve( Start( ~tid, $C, $S.1, 'client' ) @ #j.1 )
                      case C_0
                      solve( TLS_Recv( ~tid, $PH.1, $S,
                                       <<'11', certificate_request_context, pk(~ltkA.1)>, 
                                        <'15', 
                                         sign(<'ExportedAuthenticator', 
                                               h(<
                                                  Expand(Expand(Expand(~ms,
                                                                       <'32', 
                                                                        'TLS13exportermastersecret', 
                                                                        h(~n)>,
                                                                       '32'),
                                                                <'32', 
                                                                 'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                 'empty'>,
                                                                '32'),
                                                         <'32', 'exporter', h(<'empty', '32'>)>,
                                                         '32'), 
                                                  <'13', certificate_request_context, 
                                                   $certificate_extensions>, 
                                                  pk(~ltkA.1)>)
                                              >,
                                              ~ltkA.1)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorfinishedkey', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context, 
                                               $certificate_extensions>, 
                                              <'11', certificate_request_context, pk(~ltkA.1)>, 
                                              '15', 
                                              sign(<'ExportedAuthenticator', 
                                                    h(<
                                                       Expand(Expand(Expand(~ms,
                                                                            <'32', 
                                                                             'TLS13exportermastersecret', 
                                                                             h(~n)>,
                                                                            '32'),
                                                                     <'32', 
                                                                      'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                      'empty'>,
                                                                     '32'),
                                                              <'32', 'exporter', h(<'empty', '32'>)
                                                              >,
                                                              '32'), 
                                                       <'13', certificate_request_context, 
                                                        $certificate_extensions>, 
                                                       pk(~ltkA.1)>)
                                                   >,
                                                   ~ltkA.1)
                                             >)
                                       >
                             ) ▶₁ #k )
                        case Send_TLS_Channel_target_case_1
                        by contradiction /* from formulas */
                      next
                        case Send_TLS_Channel_target_case_2
                        by contradiction /* from formulas */
                      next
                        case Send_TLS_Channel_target_case_3
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              next
                case C_Recv_Spontaneous
                solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₃ #k )
                  case Register_pk
                  solve( Start( ~tid.1, $C, $S.1, 'client' ) @ #j.3 )
                    case C_0
                    solve( !Exporters( ~ms, 'client', ~tid.1, hccc, hccs, fmc, fms
                           ) ▶₂ #k )
                      case Create_TLS_channel_uni
                      solve( TLS_Recv( ~tid, $PH.1, $S,
                                       <<'11', pk(~ltkA.1)>, 
                                        <'15', 
                                         sign(<'ExportedAuthenticator', 
                                               h(<
                                                  Expand(Expand(Expand(~ms,
                                                                       <'32', 
                                                                        'TLS13exportermastersecret', 
                                                                        h(~n)>,
                                                                       '32'),
                                                                <'32', 
                                                                 'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                 'empty'>,
                                                                '32'),
                                                         <'32', 'exporter', h(<'empty', '32'>)>,
                                                         '32'), 
                                                  pk(~ltkA.1)>)
                                              >,
                                              ~ltkA.1)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorfinishedkey', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_serverauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'11', pk(~ltkA.1)>, '15', 
                                              sign(<'ExportedAuthenticator', 
                                                    h(<
                                                       Expand(Expand(Expand(~ms,
                                                                            <'32', 
                                                                             'TLS13exportermastersecret', 
                                                                             h(~n)>,
                                                                            '32'),
                                                                     <'32', 
                                                                      'EXPORTER_serverauthenticatorhandshakecontext', 
                                                                      'empty'>,
                                                                     '32'),
                                                              <'32', 'exporter', h(<'empty', '32'>)
                                                              >,
                                                              '32'), 
                                                       pk(~ltkA.1)>)
                                                   >,
                                                   ~ltkA.1)
                                             >)
                                       >
                             ) ▶₁ #k )
                        case Send_TLS_Channel_target
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case S_Recv
  solve( Recv( $S, ~ms, 'server', <del2, pk(ltkD2)> ) @ #k )
    case S_Recv
    solve( Start( ~tid, $S, $C, 'server' ) @ #j.1 )
      case S_0
      solve( Start( ~tid.1, $S, $C.1, 'server' ) @ #j.2 )
        case S_0
        solve( !Pk( $A.1, pk(~ltkA.1) ) ▶₄ #k )
          case Register_pk
          solve( !Pk( $A, pk(~ltkA) ) ▶₄ #j )
            case Register_pk
            solve( !Exporters( ~ms, 'server', ~tid, hccc, hccs, fmc, fms
                   ) ▶₃ #j )
              case Create_Adv_TLS_channel
              solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                     ) ▶₃ #k )
                case Create_Adv_TLS_channel
                solve( !Exporters( ~ms.1, 'server', ~tid, hccc, hccs, fmc, fms
                       ) ▶₀ #j.1 )
                  case Create_Adv_TLS_channel
                  solve( TLS_Recv( ~tid, $C, $S,
                                   <<'11', certificate_request_context, pk(~ltkA)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_clientauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context, 
                                               $certificate_extensions>, 
                                              pk(~ltkA)>)
                                          >,
                                          ~ltkA)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_clientauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_clientauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'13', certificate_request_context, 
                                           $certificate_extensions>, 
                                          <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   <'13', certificate_request_context, 
                                                    $certificate_extensions>, 
                                                   pk(~ltkA)>)
                                               >,
                                               ~ltkA)
                                         >)
                                   >
                         ) ▶₁ #j )
                    case Send_TLS_Channel_owner_uni
                    solve( TLS_Recv( ~tid, $C, $S,
                                     <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                      <'15', 
                                       sign(<'ExportedAuthenticator', 
                                             h(<
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorhandshakecontext', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                <'13', certificate_request_context.1, 
                                                 $certificate_extensions.1>, 
                                                pk(~ltkA.1)>)
                                            >,
                                            ~ltkA.1)
                                      >, 
                                      '20', 
                                      hmac(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_clientauthenticatorfinishedkey', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_clientauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context.1, 
                                             $certificate_extensions.1>, 
                                            <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                            '15', 
                                            sign(<'ExportedAuthenticator', 
                                                  h(<
                                                     Expand(Expand(Expand(~ms,
                                                                          <'32', 
                                                                           'TLS13exportermastersecret', 
                                                                           h(~n)>,
                                                                          '32'),
                                                                   <'32', 
                                                                    'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                    'empty'>,
                                                                   '32'),
                                                            <'32', 'exporter', h(<'empty', '32'>)>,
                                                            '32'), 
                                                     <'13', certificate_request_context.1, 
                                                      $certificate_extensions.1>, 
                                                     pk(~ltkA.1)>)
                                                 >,
                                                 ~ltkA.1)
                                           >)
                                     >
                           ) ▶₁ #k )
                      case Send_TLS_Channel_owner_uni
                      solve( !KU( sign(<'ExportedAuthenticator', 
                                        h(<
                                           Expand(Expand(Expand(~ms,
                                                                <'32', 'TLS13exportermastersecret', 
                                                                 h(~n)>,
                                                                '32'),
                                                         <'32', 
                                                          'EXPORTER_clientauthenticatorhandshakecontext', 
                                                          'empty'>,
                                                         '32'),
                                                  <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                           <'13', certificate_request_context, 
                                            $certificate_extensions>, 
                                           pk(~ltkA)>)
                                       >,
                                       ~ltkA)
                             ) @ #vk.14 )
                        case c_sign
                        solve( !KU( ~ltkA ) @ #vk.27 )
                          case Adv_Recv_TLS_case_1
                          by solve( TLS_Recv( ~tid.1, $S.3, $PH,
                                              <'13', ~ltkA, $certificate_extensions.2>
                                    ) ▶₁ #vr.16 )
                        next
                          case Adv_Recv_TLS_case_2
                          by solve( TLS_Recv( ~tid.1, $S.2, $PH,
                                              <'13', ~ltkA, $certificate_extensions.2>
                                    ) ▶₁ #vr.16 )
                        next
                          case Adv_Recv_TLS_case_3
                          solve( TLS_Recv( ~tid.1, $C.2, $S.3,
                                           <'13', ~ltkA, $certificate_extensions.2>
                                 ) ▶₁ #vr.16 )
                            case Send_TLS_Channel_owner_uni
                            by contradiction /* cyclic */
                          qed
                        next
                          case Adv_Recv_TLS_case_4
                          solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                                           <'13', ~ltkA, $certificate_extensions.2>
                                 ) ▶₁ #vr.16 )
                            case Send_TLS_Channel_owner_bi
                            by contradiction /* cyclic */
                          qed
                        next
                          case Adv_Recv_TLS_case_5
                          solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                                           <'13', ~ltkA, $certificate_extensions.2>
                                 ) ▶₁ #vr.16 )
                            case Send_TLS_Channel_owner_uni
                            by contradiction /* cyclic */
                          qed
                        next
                          case Reveal_ltk
                          solve( !KU( sign(<'ExportedAuthenticator', 
                                            h(<
                                               Expand(Expand(Expand(~ms,
                                                                    <'32', 
                                                                     'TLS13exportermastersecret', 
                                                                     h(~n)>,
                                                                    '32'),
                                                             <'32', 
                                                              'EXPORTER_clientauthenticatorhandshakecontext', 
                                                              'empty'>,
                                                             '32'),
                                                      <'32', 'exporter', h(<'empty', '32'>)>,
                                                      '32'), 
                                               <'13', certificate_request_context.1, 
                                                $certificate_extensions.1>, 
                                               pk(~ltkA.1)>)
                                           >,
                                           ~ltkA.1)
                                 ) @ #vk.25 )
                            case c_sign
                            solve( !KU( ~ltkA.1 ) @ #vk.31 )
                              case Adv_Recv_TLS_case_1
                              by solve( TLS_Recv( ~tid.1, $S.3, $PH,
                                                  <'13', ~ltkA.1, $certificate_extensions.2>
                                        ) ▶₁ #vr.17 )
                            next
                              case Adv_Recv_TLS_case_2
                              by solve( TLS_Recv( ~tid.1, $S.2, $PH,
                                                  <'13', ~ltkA.1, $certificate_extensions.2>
                                        ) ▶₁ #vr.17 )
                            next
                              case Adv_Recv_TLS_case_3
                              solve( TLS_Recv( ~tid.1, $C.2, $S.3,
                                               <'13', ~ltkA.1, $certificate_extensions.2>
                                     ) ▶₁ #vr.17 )
                                case Send_TLS_Channel_owner_uni
                                by contradiction /* cyclic */
                              qed
                            next
                              case Adv_Recv_TLS_case_4
                              solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                                               <'13', ~ltkA.1, $certificate_extensions.2>
                                     ) ▶₁ #vr.17 )
                                case Send_TLS_Channel_owner_bi
                                by contradiction /* cyclic */
                              qed
                            next
                              case Adv_Recv_TLS_case_5
                              solve( TLS_Recv( ~tid.1, $C.3, $S.3,
                                               <'13', ~ltkA.1, $certificate_extensions.2>
                                     ) ▶₁ #vr.17 )
                                case Send_TLS_Channel_owner_uni
                                by contradiction /* cyclic */
                              qed
                            next
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case Create_TLS_channel_bi
              solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                     ) ▶₃ #k )
                case Create_TLS_channel_bi
                solve( !Exporters( ~ms.1, 'server', ~tid, hccc, hccs, fmc, fms
                       ) ▶₀ #j.1 )
                  case Create_TLS_channel_bi
                  solve( TLS_Recv( ~tid, $C, $S,
                                   <<'11', certificate_request_context, pk(~ltkA)>, 
                                    <'15', 
                                     sign(<'ExportedAuthenticator', 
                                           h(<
                                              Expand(Expand(Expand(~ms,
                                                                   <'32', 
                                                                    'TLS13exportermastersecret', 
                                                                    h(~n)>,
                                                                   '32'),
                                                            <'32', 
                                                             'EXPORTER_clientauthenticatorhandshakecontext', 
                                                             'empty'>,
                                                            '32'),
                                                     <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                              <'13', certificate_request_context, 
                                               $certificate_extensions>, 
                                              pk(~ltkA)>)
                                          >,
                                          ~ltkA)
                                    >, 
                                    '20', 
                                    hmac(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_clientauthenticatorfinishedkey', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_clientauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'13', certificate_request_context, 
                                           $certificate_extensions>, 
                                          <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                          sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   <'13', certificate_request_context, 
                                                    $certificate_extensions>, 
                                                   pk(~ltkA)>)
                                               >,
                                               ~ltkA)
                                         >)
                                   >
                         ) ▶₁ #j )
                    case Send_TLS_Channel_owner_bi_case_1
                    solve( TLS_Recv( ~tid, $C, $S,
                                     <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                      <'15', 
                                       sign(<'ExportedAuthenticator', 
                                             h(<
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorhandshakecontext', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                <'13', certificate_request_context.1, 
                                                 $certificate_extensions.1>, 
                                                pk(~ltkA.1)>)
                                            >,
                                            ~ltkA.1)
                                      >, 
                                      '20', 
                                      hmac(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_clientauthenticatorfinishedkey', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_clientauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context.1, 
                                             $certificate_extensions.1>, 
                                            <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                            '15', 
                                            sign(<'ExportedAuthenticator', 
                                                  h(<
                                                     Expand(Expand(Expand(~ms,
                                                                          <'32', 
                                                                           'TLS13exportermastersecret', 
                                                                           h(~n)>,
                                                                          '32'),
                                                                   <'32', 
                                                                    'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                    'empty'>,
                                                                   '32'),
                                                            <'32', 'exporter', h(<'empty', '32'>)>,
                                                            '32'), 
                                                     <'13', certificate_request_context.1, 
                                                      $certificate_extensions.1>, 
                                                     pk(~ltkA.1)>)
                                                 >,
                                                 ~ltkA.1)
                                           >)
                                     >
                           ) ▶₁ #k )
                      case Send_TLS_Channel_owner_bi_case_1
                      solve( !KU( sign(<'ExportedAuthenticator', 
                                        h(<
                                           Expand(Expand(Expand(~ms,
                                                                <'32', 'TLS13exportermastersecret', 
                                                                 h(~n)>,
                                                                '32'),
                                                         <'32', 
                                                          'EXPORTER_clientauthenticatorhandshakecontext', 
                                                          'empty'>,
                                                         '32'),
                                                  <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                           <'13', certificate_request_context, 
                                            $certificate_extensions>, 
                                           pk(~ltkA)>)
                                       >,
                                       ~ltkA)
                             ) @ #vk.14 )
                        case Adv_Recv_TLS_case_1
                        solve( (($TP.1 = $C) ∧ ($S.1 = $S))  ∥
                               (($TP.1 = $S) ∧ ($S.1 = $C)) )
                          case case_1
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              solve( !KU( sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   <'13', certificate_request_context.1, 
                                                    $certificate_extensions.1>, 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                     ) @ #vk.24 )
                                case Adv_Recv_TLS_case_1
                                solve( (($TP = $C) ∧ ($S.1 = $S))  ∥ (($TP = $S) ∧ ($S.1 = $C)) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( Start( ~tid.1, $S, $C, 'client' ) @ #vr.3 )
                                    case C_0
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case Adv_Recv_TLS_case_2
                                solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                  case C_0
                                  by contradiction /* from formulas */
                                qed
                              next
                                case Adv_Recv_TLS_case_3
                                solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                  case C_0
                                  by contradiction /* from formulas */
                                qed
                              next
                                case c_sign
                                solve( !KU( ~ltkA.1 ) @ #vk.28 )
                                  case Adv_Recv_TLS_case_1
                                  solve( Start( ~tid.2, $C.3, $S.3, 'client' ) @ #vr.28 )
                                    case C_0
                                    by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                        <'13', ~ltkA.1, $certificate_extensions.2>
                                              ) ▶₁ #vr.26 )
                                  qed
                                next
                                  case Adv_Recv_TLS_case_2
                                  by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                      <'13', ~ltkA.1, $certificate_extensions.2>
                                            ) ▶₁ #vr.26 )
                                next
                                  case Adv_Recv_TLS_case_3
                                  solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                                   <'13', ~ltkA.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.26 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_4
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                   <'13', ~ltkA.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.26 )
                                    case Send_TLS_Channel_owner_bi
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_5
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                   <'13', ~ltkA.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.26 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Reveal_ltk
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( Start( ~tid.1, $S, $C, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S, 'client' ) @ #vr.3 )
                              case C_0
                              solve( !KU( sign(<'ExportedAuthenticator', 
                                                h(<
                                                   Expand(Expand(Expand(~ms,
                                                                        <'32', 
                                                                         'TLS13exportermastersecret', 
                                                                         h(~n)>,
                                                                        '32'),
                                                                 <'32', 
                                                                  'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                  'empty'>,
                                                                 '32'),
                                                          <'32', 'exporter', h(<'empty', '32'>)>,
                                                          '32'), 
                                                   <'13', certificate_request_context.1, 
                                                    $certificate_extensions.1>, 
                                                   pk(~ltkA.1)>)
                                               >,
                                               ~ltkA.1)
                                     ) @ #vk.24 )
                                case Adv_Recv_TLS_case_1
                                by contradiction /* from formulas */
                              next
                                case Adv_Recv_TLS_case_2
                                by contradiction /* from formulas */
                              next
                                case Adv_Recv_TLS_case_3
                                by contradiction /* from formulas */
                              next
                                case c_sign
                                solve( !KU( ~ltkA.1 ) @ #vk.28 )
                                  case Adv_Recv_TLS_case_1
                                  by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                      <'13', ~ltkA.1, $certificate_extensions.2>
                                            ) ▶₁ #vr.26 )
                                next
                                  case Adv_Recv_TLS_case_2
                                  by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                      <'13', ~ltkA.1, $certificate_extensions.2>
                                            ) ▶₁ #vr.26 )
                                next
                                  case Adv_Recv_TLS_case_3
                                  solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                   <'13', ~ltkA.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.26 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_4
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                   <'13', ~ltkA.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.26 )
                                    case Send_TLS_Channel_owner_bi
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_5
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                   <'13', ~ltkA.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.26 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Reveal_ltk
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case Adv_Recv_TLS_case_2
                        solve( Start( ~tid.1, $TP.1, $S.1, 'client' ) @ #vr.3 )
                          case C_0
                          solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                            case C_0
                            solve( TLS_Recv( ~tid.1, $S, $PH,
                                             <'13', ~certificate_request_context, 
                                              $certificate_extensions>
                                   ) ▶₁ #vr.16 )
                              case Send_TLS_Channel_target_case_1
                              by solve( Start( ~tid, $S, $PH, 'client' ) @ #j.1 )
                            next
                              case Send_TLS_Channel_target_case_2
                              solve( Start( ~tid, $PH, $S, 'server' ) @ #j.1 )
                                case S_0
                                solve( !KU( sign(<'ExportedAuthenticator', 
                                                  h(<
                                                     Expand(Expand(Expand(~ms,
                                                                          <'32', 
                                                                           'TLS13exportermastersecret', 
                                                                           h(~n)>,
                                                                          '32'),
                                                                   <'32', 
                                                                    'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                    'empty'>,
                                                                   '32'),
                                                            <'32', 'exporter', h(<'empty', '32'>)>,
                                                            '32'), 
                                                     <'13', certificate_request_context.1, 
                                                      $certificate_extensions.1>, 
                                                     pk(~ltkA.1)>)
                                                 >,
                                                 ~ltkA.1)
                                       ) @ #vk.24 )
                                  case Adv_Recv_TLS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case Adv_Recv_TLS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case Adv_Recv_TLS_case_3
                                  by contradiction /* from formulas */
                                next
                                  case c_sign
                                  solve( !KU( ~ltkA.1 ) @ #vk.28 )
                                    case Adv_Recv_TLS_case_1
                                    solve( Start( ~tid.2, $C.1, $S, 'client' ) @ #vr.30 )
                                      case C_0
                                      solve( Start( ~tid.2, $C.2, $S.1, 'client' ) @ #vr.30 )
                                        case C_0
                                        by solve( TLS_Recv( ~tid.2, $S, $PH,
                                                            <'13', ~ltkA.1, 
                                                             $certificate_extensions.2>
                                                  ) ▶₁ #vr.28 )
                                      qed
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_2
                                    by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                        <'13', ~ltkA.1, $certificate_extensions.2>
                                              ) ▶₁ #vr.28 )
                                  next
                                    case Adv_Recv_TLS_case_3
                                    solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                     <'13', ~ltkA.1, $certificate_extensions.2>
                                           ) ▶₁ #vr.28 )
                                      case Send_TLS_Channel_owner_uni
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_4
                                    solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                     <'13', ~ltkA.1, $certificate_extensions.2>
                                           ) ▶₁ #vr.28 )
                                      case Send_TLS_Channel_owner_bi
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_5
                                    solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                     <'13', ~ltkA.1, $certificate_extensions.2>
                                           ) ▶₁ #vr.28 )
                                      case Send_TLS_Channel_owner_uni
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Reveal_ltk
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case Adv_Recv_TLS_case_3
                        solve( Start( ~tid.1, $TP.1, $S.1, 'client' ) @ #vr.3 )
                          case C_0
                          by solve( Start( ~tid.1, $S.1, $C.1, 'server' ) @ #vr.3 )
                        qed
                      next
                        case c_sign
                        solve( !KU( sign(<'ExportedAuthenticator', 
                                          h(<
                                             Expand(Expand(Expand(~ms,
                                                                  <'32', 
                                                                   'TLS13exportermastersecret', 
                                                                   h(~n)>,
                                                                  '32'),
                                                           <'32', 
                                                            'EXPORTER_clientauthenticatorhandshakecontext', 
                                                            'empty'>,
                                                           '32'),
                                                    <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                             <'13', certificate_request_context.1, 
                                              $certificate_extensions.1>, 
                                             pk(~ltkA.1)>)
                                         >,
                                         ~ltkA.1)
                               ) @ #vk.24 )
                          case Adv_Recv_TLS_case_1
                          solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              solve( !KU( ~ltkA ) @ #vk.27 )
                                case Adv_Recv_TLS_case_1
                                solve( Start( ~tid.2, $C.1, $S.1, 'client' ) @ #vr.28 )
                                  case C_0
                                  solve( Start( ~tid.2, $C.2, $S.2, 'client' ) @ #vr.28 )
                                    case C_0
                                    by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                        <'13', ~ltkA, $certificate_extensions.2>
                                              ) ▶₁ #vr.26 )
                                  qed
                                qed
                              next
                                case Adv_Recv_TLS_case_2
                                by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                    <'13', ~ltkA, $certificate_extensions.2>
                                          ) ▶₁ #vr.26 )
                              next
                                case Adv_Recv_TLS_case_3
                                solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                                 <'13', ~ltkA, $certificate_extensions.2>
                                       ) ▶₁ #vr.26 )
                                  case Send_TLS_Channel_owner_uni
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Adv_Recv_TLS_case_4
                                solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                 <'13', ~ltkA, $certificate_extensions.2>
                                       ) ▶₁ #vr.26 )
                                  case Send_TLS_Channel_owner_bi
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Adv_Recv_TLS_case_5
                                solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                 <'13', ~ltkA, $certificate_extensions.2>
                                       ) ▶₁ #vr.26 )
                                  case Send_TLS_Channel_owner_uni
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Reveal_ltk
                                solve( !KU( ~tid ) @ #vk.30 )
                                  case Adv_Recv_TLS_case_1
                                  by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                                      <'13', ~tid, $certificate_extensions.2>
                                            ) ▶₁ #vr.27 )
                                next
                                  case Adv_Recv_TLS_case_2
                                  by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                      <'13', ~tid, $certificate_extensions.2>
                                            ) ▶₁ #vr.27 )
                                next
                                  case Adv_Recv_TLS_case_3
                                  solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                                   <'13', ~tid, $certificate_extensions.2>
                                         ) ▶₁ #vr.27 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_4
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                   <'13', ~tid, $certificate_extensions.2>
                                         ) ▶₁ #vr.27 )
                                    case Send_TLS_Channel_owner_bi
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_5
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                   <'13', ~tid, $certificate_extensions.2>
                                         ) ▶₁ #vr.27 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Adv_Recv_TLS_case_2
                          solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              solve( TLS_Recv( ~tid.1, $S, $PH,
                                               <'13', ~certificate_request_context.1, 
                                                $certificate_extensions.1>
                                     ) ▶₁ #vr.16 )
                                case Send_TLS_Channel_target_case_1
                                by solve( Start( ~tid, $S, $PH, 'client' ) @ #j.1 )
                              next
                                case Send_TLS_Channel_target_case_2
                                solve( Start( ~tid, $PH, $S, 'server' ) @ #j.1 )
                                  case S_0
                                  solve( !KU( ~tid ) @ #vk.30 )
                                    case Adv_Recv_TLS_case_1
                                    by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                        <'13', ~tid, $certificate_extensions.2>
                                              ) ▶₁ #vr.28 )
                                  next
                                    case Adv_Recv_TLS_case_2
                                    by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                        <'13', ~tid, $certificate_extensions.2>
                                              ) ▶₁ #vr.28 )
                                  next
                                    case Adv_Recv_TLS_case_3
                                    solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                     <'13', ~tid, $certificate_extensions.2>
                                           ) ▶₁ #vr.28 )
                                      case Send_TLS_Channel_owner_uni
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_4
                                    solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                     <'13', ~tid, $certificate_extensions.2>
                                           ) ▶₁ #vr.28 )
                                      case Send_TLS_Channel_owner_bi
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_5
                                    solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                     <'13', ~tid, $certificate_extensions.2>
                                           ) ▶₁ #vr.28 )
                                      case Send_TLS_Channel_owner_uni
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case Adv_Recv_TLS_case_3
                          solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                            case C_0
                            by solve( Start( ~tid.1, $S.1, $C.1, 'server' ) @ #vr.3 )
                          qed
                        next
                          case c_sign
                          solve( !KU( ~ltkA ) @ #vk.27 )
                            case Adv_Recv_TLS_case_1
                            by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                                <'13', ~ltkA, $certificate_extensions.2>
                                      ) ▶₁ #vr.17 )
                          next
                            case Adv_Recv_TLS_case_2
                            by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                <'13', ~ltkA, $certificate_extensions.2>
                                      ) ▶₁ #vr.17 )
                          next
                            case Adv_Recv_TLS_case_3
                            solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                             <'13', ~ltkA, $certificate_extensions.2>
                                   ) ▶₁ #vr.17 )
                              case Send_TLS_Channel_owner_uni
                              by contradiction /* cyclic */
                            qed
                          next
                            case Adv_Recv_TLS_case_4
                            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                             <'13', ~ltkA, $certificate_extensions.2>
                                   ) ▶₁ #vr.17 )
                              case Send_TLS_Channel_owner_bi
                              by contradiction /* cyclic */
                            qed
                          next
                            case Adv_Recv_TLS_case_5
                            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                             <'13', ~ltkA, $certificate_extensions.2>
                                   ) ▶₁ #vr.17 )
                              case Send_TLS_Channel_owner_uni
                              by contradiction /* cyclic */
                            qed
                          next
                            case Reveal_ltk
                            solve( !KU( ~ltkA.1 ) @ #vk.31 )
                              case Adv_Recv_TLS_case_1
                              by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                                  <'13', ~ltkA.1, $certificate_extensions.2>
                                        ) ▶₁ #vr.18 )
                            next
                              case Adv_Recv_TLS_case_2
                              by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                  <'13', ~ltkA.1, $certificate_extensions.2>
                                        ) ▶₁ #vr.18 )
                            next
                              case Adv_Recv_TLS_case_3
                              solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                               <'13', ~ltkA.1, $certificate_extensions.2>
                                     ) ▶₁ #vr.18 )
                                case Send_TLS_Channel_owner_uni
                                by contradiction /* cyclic */
                              qed
                            next
                              case Adv_Recv_TLS_case_4
                              solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                               <'13', ~ltkA.1, $certificate_extensions.2>
                                     ) ▶₁ #vr.18 )
                                case Send_TLS_Channel_owner_bi
                                by contradiction /* cyclic */
                              qed
                            next
                              case Adv_Recv_TLS_case_5
                              solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                               <'13', ~ltkA.1, $certificate_extensions.2>
                                     ) ▶₁ #vr.18 )
                                case Send_TLS_Channel_owner_uni
                                by contradiction /* cyclic */
                              qed
                            next
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Send_TLS_Channel_owner_bi_case_2
                      solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                        case C_0
                        solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                          case C_0
                          solve( !KU( sign(<'ExportedAuthenticator', 
                                            h(<
                                               Expand(Expand(Expand(~ms,
                                                                    <'32', 
                                                                     'TLS13exportermastersecret', 
                                                                     h(~n)>,
                                                                    '32'),
                                                             <'32', 
                                                              'EXPORTER_clientauthenticatorhandshakecontext', 
                                                              'empty'>,
                                                             '32'),
                                                      <'32', 'exporter', h(<'empty', '32'>)>,
                                                      '32'), 
                                               <'13', certificate_request_context, 
                                                $certificate_extensions>, 
                                               pk(~ltkA)>)
                                           >,
                                           ~ltkA)
                                 ) @ #vk.11 )
                            case Adv_Recv_TLS_case_1
                            solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              by contradiction /* from formulas */
                            qed
                          next
                            case Adv_Recv_TLS_case_2
                            solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              by contradiction /* from formulas */
                            qed
                          next
                            case Adv_Recv_TLS_case_3
                            solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              by contradiction /* from formulas */
                            qed
                          next
                            case c_sign
                            solve( !KU( ~ltkA ) @ #vk.16 )
                              case Adv_Recv_TLS_case_1
                              solve( Start( ~tid.2, $C.1, $S.1, 'client' ) @ #vr.20 )
                                case C_0
                                solve( Start( ~tid.2, $C.2, $S.2, 'client' ) @ #vr.20 )
                                  case C_0
                                  by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                      <'13', ~ltkA, $certificate_extensions.2>
                                            ) ▶₁ #vr.18 )
                                qed
                              qed
                            next
                              case Adv_Recv_TLS_case_2
                              by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                  <'13', ~ltkA, $certificate_extensions.2>
                                        ) ▶₁ #vr.18 )
                            next
                              case Adv_Recv_TLS_case_3
                              solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                               <'13', ~ltkA, $certificate_extensions.2>
                                     ) ▶₁ #vr.18 )
                                case Send_TLS_Channel_owner_uni
                                by contradiction /* cyclic */
                              qed
                            next
                              case Adv_Recv_TLS_case_4
                              solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                               <'13', ~ltkA, $certificate_extensions.2>
                                     ) ▶₁ #vr.18 )
                                case Send_TLS_Channel_owner_bi
                                by contradiction /* cyclic */
                              qed
                            next
                              case Adv_Recv_TLS_case_5
                              solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                               <'13', ~ltkA, $certificate_extensions.2>
                                     ) ▶₁ #vr.18 )
                                case Send_TLS_Channel_owner_uni
                                by contradiction /* cyclic */
                              qed
                            next
                              case Reveal_ltk
                              solve( !KU( ~tid.1 ) @ #vk.4 )
                                case Adv_Recv_TLS_case_1
                                by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                                    <'13', ~tid.1, $certificate_extensions.2>
                                          ) ▶₁ #vr.19 )
                              next
                                case Adv_Recv_TLS_case_2
                                by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                    <'13', ~tid.1, $certificate_extensions.2>
                                          ) ▶₁ #vr.19 )
                              next
                                case Adv_Recv_TLS_case_3
                                solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                                 <'13', ~tid.1, $certificate_extensions.2>
                                       ) ▶₁ #vr.19 )
                                  case Send_TLS_Channel_owner_uni
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Adv_Recv_TLS_case_4
                                solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                 <'13', ~tid.1, $certificate_extensions.2>
                                       ) ▶₁ #vr.19 )
                                  case Send_TLS_Channel_owner_bi
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Adv_Recv_TLS_case_5
                                solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                                 <'13', ~tid.1, $certificate_extensions.2>
                                       ) ▶₁ #vr.19 )
                                  case Send_TLS_Channel_owner_uni
                                  by contradiction /* cyclic */
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case Send_TLS_Channel_owner_bi_case_3
                      solve( !KU( sign(<'ExportedAuthenticator', 
                                        h(<
                                           Expand(Expand(Expand(~ms,
                                                                <'32', 'TLS13exportermastersecret', 
                                                                 h(~n)>,
                                                                '32'),
                                                         <'32', 
                                                          'EXPORTER_clientauthenticatorhandshakecontext', 
                                                          'empty'>,
                                                         '32'),
                                                  <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                           <'13', certificate_request_context, 
                                            $certificate_extensions>, 
                                           pk(~ltkA)>)
                                       >,
                                       ~ltkA)
                             ) @ #vk.11 )
                        case Adv_Recv_TLS_case_1
                        solve( TLS_Recv( ~tid.1, $S.1, $PH,
                                         <'13', ~certificate_request_context.1, 
                                          $certificate_extensions.1>
                               ) ▶₁ #vr.8 )
                          case Send_TLS_Channel_target_case_1
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.2, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                case C_0
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        next
                          case Send_TLS_Channel_target_case_2
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.2, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                case C_0
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      next
                        case Adv_Recv_TLS_case_2
                        solve( TLS_Recv( ~tid.1, $S.1, $PH,
                                         <'13', ~certificate_request_context.1, 
                                          $certificate_extensions.1>
                               ) ▶₁ #vr.8 )
                          case Send_TLS_Channel_target_case_1
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.2, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                case C_0
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        next
                          case Send_TLS_Channel_target_case_2
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.2, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                case C_0
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      next
                        case Adv_Recv_TLS_case_3
                        solve( TLS_Recv( ~tid.1, $S.1, $PH,
                                         <'13', ~certificate_request_context.1, 
                                          $certificate_extensions.1>
                               ) ▶₁ #vr.8 )
                          case Send_TLS_Channel_target_case_1
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.2, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                case C_0
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        next
                          case Send_TLS_Channel_target_case_2
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.2, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid.1, $TP, $S.1, 'client' ) @ #vr.3 )
                                case C_0
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_sign
                        solve( TLS_Recv( ~tid.1, $S.1, $PH,
                                         <'13', ~certificate_request_context.1, 
                                          $certificate_extensions.1>
                               ) ▶₁ #vr.8 )
                          case Send_TLS_Channel_target_case_1
                          solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                            case C_0
                            by solve( Start( ~tid, $S, $PH, 'client' ) @ #j.1 )
                          qed
                        next
                          case Send_TLS_Channel_target_case_2
                          solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                            case C_0
                            solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                              case C_0
                              solve( Start( ~tid, $PH, $S, 'server' ) @ #j.1 )
                                case S_0
                                solve( !KU( ~ltkA ) @ #vk.16 )
                                  case Adv_Recv_TLS_case_1
                                  by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                      <'13', ~ltkA, $certificate_extensions.2>
                                            ) ▶₁ #vr.20 )
                                next
                                  case Adv_Recv_TLS_case_2
                                  by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                      <'13', ~ltkA, $certificate_extensions.2>
                                            ) ▶₁ #vr.20 )
                                next
                                  case Adv_Recv_TLS_case_3
                                  solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                   <'13', ~ltkA, $certificate_extensions.2>
                                         ) ▶₁ #vr.20 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_4
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                   <'13', ~ltkA, $certificate_extensions.2>
                                         ) ▶₁ #vr.20 )
                                    case Send_TLS_Channel_owner_bi
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_5
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                   <'13', ~ltkA, $certificate_extensions.2>
                                         ) ▶₁ #vr.20 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Reveal_ltk
                                  solve( !KU( ~tid.1 ) @ #vk.6 )
                                    case Adv_Recv_TLS_case_1
                                    by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                        <'13', ~tid.1, $certificate_extensions.2>
                                              ) ▶₁ #vr.21 )
                                  next
                                    case Adv_Recv_TLS_case_2
                                    by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                        <'13', ~tid.1, $certificate_extensions.2>
                                              ) ▶₁ #vr.21 )
                                  next
                                    case Adv_Recv_TLS_case_3
                                    solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                     <'13', ~tid.1, $certificate_extensions.2>
                                           ) ▶₁ #vr.21 )
                                      case Send_TLS_Channel_owner_uni
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_4
                                    solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                     <'13', ~tid.1, $certificate_extensions.2>
                                           ) ▶₁ #vr.21 )
                                      case Send_TLS_Channel_owner_bi
                                      by contradiction /* cyclic */
                                    qed
                                  next
                                    case Adv_Recv_TLS_case_5
                                    solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                     <'13', ~tid.1, $certificate_extensions.2>
                                           ) ▶₁ #vr.21 )
                                      case Send_TLS_Channel_owner_uni
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case Send_TLS_Channel_owner_bi_case_4
                      solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                        case C_0
                        by solve( Start( ~tid.1, $S.1, $C.1, 'server' ) @ #vr.3 )
                      qed
                    qed
                  next
                    case Send_TLS_Channel_owner_bi_case_2
                    solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                      case C_0
                      solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                        case C_0
                        solve( TLS_Recv( ~tid, $C, $S,
                                         <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                          <'15', 
                                           sign(<'ExportedAuthenticator', 
                                                 h(<
                                                    Expand(Expand(Expand(~ms,
                                                                         <'32', 
                                                                          'TLS13exportermastersecret', 
                                                                          h(~n)>,
                                                                         '32'),
                                                                  <'32', 
                                                                   'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                   'empty'>,
                                                                  '32'),
                                                           <'32', 'exporter', h(<'empty', '32'>)>,
                                                           '32'), 
                                                    <'13', certificate_request_context.1, 
                                                     $certificate_extensions.1>, 
                                                    pk(~ltkA.1)>)
                                                >,
                                                ~ltkA.1)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorfinishedkey', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorhandshakecontext', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                <'13', certificate_request_context.1, 
                                                 $certificate_extensions.1>, 
                                                <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                                '15', 
                                                sign(<'ExportedAuthenticator', 
                                                      h(<
                                                         Expand(Expand(Expand(~ms,
                                                                              <'32', 
                                                                               'TLS13exportermastersecret', 
                                                                               h(~n)>,
                                                                              '32'),
                                                                       <'32', 
                                                                        'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                        'empty'>,
                                                                       '32'),
                                                                <'32', 'exporter', 
                                                                 h(<'empty', '32'>)>,
                                                                '32'), 
                                                         <'13', certificate_request_context.1, 
                                                          $certificate_extensions.1>, 
                                                         pk(~ltkA.1)>)
                                                     >,
                                                     ~ltkA.1)
                                               >)
                                         >
                               ) ▶₁ #k )
                          case Send_TLS_Channel_owner_bi_case_1
                          solve( !KU( ~tid.1 ) @ #vk.1 )
                            case Adv_Recv_TLS_case_1
                            by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                                <'13', ~tid.1, $certificate_extensions.2>
                                      ) ▶₁ #vr.18 )
                          next
                            case Adv_Recv_TLS_case_2
                            by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                <'13', ~tid.1, $certificate_extensions.2>
                                      ) ▶₁ #vr.18 )
                          next
                            case Adv_Recv_TLS_case_3
                            solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                             <'13', ~tid.1, $certificate_extensions.2>
                                   ) ▶₁ #vr.18 )
                              case Send_TLS_Channel_owner_uni
                              by contradiction /* cyclic */
                            qed
                          next
                            case Adv_Recv_TLS_case_4
                            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                             <'13', ~tid.1, $certificate_extensions.2>
                                   ) ▶₁ #vr.18 )
                              case Send_TLS_Channel_owner_bi
                              by contradiction /* cyclic */
                            qed
                          next
                            case Adv_Recv_TLS_case_5
                            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                             <'13', ~tid.1, $certificate_extensions.2>
                                   ) ▶₁ #vr.18 )
                              case Send_TLS_Channel_owner_uni
                              by contradiction /* cyclic */
                            qed
                          qed
                        next
                          case Send_TLS_Channel_owner_bi_case_2
                          by contradiction /* from formulas */
                        next
                          case Send_TLS_Channel_owner_bi_case_3
                          by contradiction /* from formulas */
                        next
                          case Send_TLS_Channel_owner_bi_case_4
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  next
                    case Send_TLS_Channel_owner_bi_case_3
                    solve( TLS_Recv( ~tid.1, $S.2, $PH,
                                     <'13', ~certificate_request_context, $certificate_extensions>
                           ) ▶₁ #vr.6 )
                      case Send_TLS_Channel_target_case_1
                      solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                        case C_0
                        solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                          case C_0
                          by solve( Start( ~tid, $S, $PH, 'client' ) @ #j.1 )
                        qed
                      qed
                    next
                      case Send_TLS_Channel_target_case_2
                      solve( Start( ~tid.1, $C, $S, 'client' ) @ #vr.3 )
                        case C_0
                        solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                          case C_0
                          solve( Start( ~tid, $PH, $S, 'server' ) @ #j.1 )
                            case S_0
                            solve( TLS_Recv( ~tid, $C, $C,
                                             <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                              <'15', 
                                               sign(<'ExportedAuthenticator', 
                                                     h(<
                                                        Expand(Expand(Expand(~ms,
                                                                             <'32', 
                                                                              'TLS13exportermastersecret', 
                                                                              h(~n)>,
                                                                             '32'),
                                                                      <'32', 
                                                                       'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                       'empty'>,
                                                                      '32'),
                                                               <'32', 'exporter', h(<'empty', '32'>)
                                                               >,
                                                               '32'), 
                                                        <'13', certificate_request_context.1, 
                                                         $certificate_extensions.1>, 
                                                        pk(~ltkA.1)>)
                                                    >,
                                                    ~ltkA.1)
                                              >, 
                                              '20', 
                                              hmac(<
                                                    Expand(Expand(Expand(~ms,
                                                                         <'32', 
                                                                          'TLS13exportermastersecret', 
                                                                          h(~n)>,
                                                                         '32'),
                                                                  <'32', 
                                                                   'EXPORTER_clientauthenticatorfinishedkey', 
                                                                   'empty'>,
                                                                  '32'),
                                                           <'32', 'exporter', h(<'empty', '32'>)>,
                                                           '32'), 
                                                    Expand(Expand(Expand(~ms,
                                                                         <'32', 
                                                                          'TLS13exportermastersecret', 
                                                                          h(~n)>,
                                                                         '32'),
                                                                  <'32', 
                                                                   'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                   'empty'>,
                                                                  '32'),
                                                           <'32', 'exporter', h(<'empty', '32'>)>,
                                                           '32'), 
                                                    <'13', certificate_request_context.1, 
                                                     $certificate_extensions.1>, 
                                                    <'11', certificate_request_context.1, 
                                                     pk(~ltkA.1)>, 
                                                    '15', 
                                                    sign(<'ExportedAuthenticator', 
                                                          h(<
                                                             Expand(Expand(Expand(~ms,
                                                                                  <'32', 
                                                                                   'TLS13exportermastersecret', 
                                                                                   h(~n)>,
                                                                                  '32'),
                                                                           <'32', 
                                                                            'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                            'empty'>,
                                                                           '32'),
                                                                    <'32', 'exporter', 
                                                                     h(<'empty', '32'>)>,
                                                                    '32'), 
                                                             <'13', certificate_request_context.1, 
                                                              $certificate_extensions.1>, 
                                                             pk(~ltkA.1)>)
                                                         >,
                                                         ~ltkA.1)
                                                   >)
                                             >
                                   ) ▶₁ #k )
                              case Send_TLS_Channel_owner_bi_case_1
                              solve( !KU( ~tid.1 ) @ #vk.1 )
                                case Adv_Recv_TLS_case_1
                                by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                    <'13', ~tid.1, $certificate_extensions.2>
                                          ) ▶₁ #vr.20 )
                              next
                                case Adv_Recv_TLS_case_2
                                by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                    <'13', ~tid.1, $certificate_extensions.2>
                                          ) ▶₁ #vr.20 )
                              next
                                case Adv_Recv_TLS_case_3
                                solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                 <'13', ~tid.1, $certificate_extensions.2>
                                       ) ▶₁ #vr.20 )
                                  case Send_TLS_Channel_owner_uni
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Adv_Recv_TLS_case_4
                                solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                 <'13', ~tid.1, $certificate_extensions.2>
                                       ) ▶₁ #vr.20 )
                                  case Send_TLS_Channel_owner_bi
                                  by contradiction /* cyclic */
                                qed
                              next
                                case Adv_Recv_TLS_case_5
                                solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                 <'13', ~tid.1, $certificate_extensions.2>
                                       ) ▶₁ #vr.20 )
                                  case Send_TLS_Channel_owner_uni
                                  by contradiction /* cyclic */
                                qed
                              qed
                            next
                              case Send_TLS_Channel_owner_bi_case_2
                              by contradiction /* from formulas */
                            next
                              case Send_TLS_Channel_owner_bi_case_3
                              by contradiction /* from formulas */
                            next
                              case Send_TLS_Channel_owner_bi_case_4
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case Send_TLS_Channel_owner_bi_case_4
                    solve( TLS_Recv( ~tid, $C, $S,
                                     <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                      <'15', 
                                       sign(<'ExportedAuthenticator', 
                                             h(<
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorhandshakecontext', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                <'13', certificate_request_context.1, 
                                                 $certificate_extensions.1>, 
                                                pk(~ltkA.1)>)
                                            >,
                                            ~ltkA.1)
                                      >, 
                                      '20', 
                                      hmac(<
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_clientauthenticatorfinishedkey', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            Expand(Expand(Expand(~ms,
                                                                 <'32', 
                                                                  'TLS13exportermastersecret', h(~n)
                                                                 >,
                                                                 '32'),
                                                          <'32', 
                                                           'EXPORTER_clientauthenticatorhandshakecontext', 
                                                           'empty'>,
                                                          '32'),
                                                   <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                            <'13', certificate_request_context.1, 
                                             $certificate_extensions.1>, 
                                            <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                            '15', 
                                            sign(<'ExportedAuthenticator', 
                                                  h(<
                                                     Expand(Expand(Expand(~ms,
                                                                          <'32', 
                                                                           'TLS13exportermastersecret', 
                                                                           h(~n)>,
                                                                          '32'),
                                                                   <'32', 
                                                                    'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                    'empty'>,
                                                                   '32'),
                                                            <'32', 'exporter', h(<'empty', '32'>)>,
                                                            '32'), 
                                                     <'13', certificate_request_context.1, 
                                                      $certificate_extensions.1>, 
                                                     pk(~ltkA.1)>)
                                                 >,
                                                 ~ltkA.1)
                                           >)
                                     >
                           ) ▶₁ #k )
                      case Send_TLS_Channel_owner_bi_case_1
                      solve( !KU( ~tid.1 ) @ #vk.1 )
                        case Adv_Recv_TLS_case_1
                        by solve( TLS_Recv( ~tid.2, $S.4, $PH,
                                            <'13', ~tid.1, $certificate_extensions.2>
                                  ) ▶₁ #vr.18 )
                      next
                        case Adv_Recv_TLS_case_2
                        by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                            <'13', ~tid.1, $certificate_extensions.2>
                                  ) ▶₁ #vr.18 )
                      next
                        case Adv_Recv_TLS_case_3
                        solve( TLS_Recv( ~tid.2, $C.3, $S.4,
                                         <'13', ~tid.1, $certificate_extensions.2>
                               ) ▶₁ #vr.18 )
                          case Send_TLS_Channel_owner_uni
                          by contradiction /* cyclic */
                        qed
                      next
                        case Adv_Recv_TLS_case_4
                        solve( TLS_Recv( ~tid.2, $C.4, $S.4,
                                         <'13', ~tid.1, $certificate_extensions.2>
                               ) ▶₁ #vr.18 )
                          case Send_TLS_Channel_owner_bi
                          by contradiction /* cyclic */
                        qed
                      next
                        case Adv_Recv_TLS_case_5
                        solve( TLS_Recv( ~tid.2, $C.4, $S.4,
                                         <'13', ~tid.1, $certificate_extensions.2>
                               ) ▶₁ #vr.18 )
                          case Send_TLS_Channel_owner_uni
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case Send_TLS_Channel_owner_bi_case_2
                      by contradiction /* from formulas */
                    next
                      case Send_TLS_Channel_owner_bi_case_3
                      by contradiction /* from formulas */
                    next
                      case Send_TLS_Channel_owner_bi_case_4
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            next
              case Create_TLS_channel_uni
              solve( TLS_Recv( ~tid, $C, $S,
                               <<'11', certificate_request_context, pk(~ltkA)>, 
                                <'15', 
                                 sign(<'ExportedAuthenticator', 
                                       h(<
                                          Expand(Expand(Expand(~ms,
                                                               <'32', 'TLS13exportermastersecret', 
                                                                h(~n)>,
                                                               '32'),
                                                        <'32', 
                                                         'EXPORTER_clientauthenticatorhandshakecontext', 
                                                         'empty'>,
                                                        '32'),
                                                 <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                          <'13', certificate_request_context, 
                                           $certificate_extensions>, 
                                          pk(~ltkA)>)
                                      >,
                                      ~ltkA)
                                >, 
                                '20', 
                                hmac(<
                                      Expand(Expand(Expand(~ms,
                                                           <'32', 'TLS13exportermastersecret', h(~n)
                                                           >,
                                                           '32'),
                                                    <'32', 
                                                     'EXPORTER_clientauthenticatorfinishedkey', 
                                                     'empty'>,
                                                    '32'),
                                             <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                      Expand(Expand(Expand(~ms,
                                                           <'32', 'TLS13exportermastersecret', h(~n)
                                                           >,
                                                           '32'),
                                                    <'32', 
                                                     'EXPORTER_clientauthenticatorhandshakecontext', 
                                                     'empty'>,
                                                    '32'),
                                             <'32', 'exporter', h(<'empty', '32'>)>, '32'), 
                                      <'13', certificate_request_context, $certificate_extensions>, 
                                      <'11', certificate_request_context, pk(~ltkA)>, '15', 
                                      sign(<'ExportedAuthenticator', 
                                            h(<
                                               Expand(Expand(Expand(~ms,
                                                                    <'32', 
                                                                     'TLS13exportermastersecret', 
                                                                     h(~n)>,
                                                                    '32'),
                                                             <'32', 
                                                              'EXPORTER_clientauthenticatorhandshakecontext', 
                                                              'empty'>,
                                                             '32'),
                                                      <'32', 'exporter', h(<'empty', '32'>)>,
                                                      '32'), 
                                               <'13', certificate_request_context, 
                                                $certificate_extensions>, 
                                               pk(~ltkA)>)
                                           >,
                                           ~ltkA)
                                     >)
                               >
                     ) ▶₁ #j )
                case Send_TLS_Channel_owner_uni_case_1
                solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                       ) ▶₃ #k )
                  case Create_TLS_channel_uni
                  solve( !Exporters( ~ms.1, 'server', ~tid, hccc, hccs, fmc, fms
                         ) ▶₀ #j.1 )
                    case Create_TLS_channel_uni
                    solve( !KU( ~tid.1 ) @ #vk.1 )
                      case Adv_Recv_TLS_case_1
                      by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                          <'13', ~tid.1, $certificate_extensions.2>
                                ) ▶₁ #vr.15 )
                    next
                      case Adv_Recv_TLS_case_2
                      by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                          <'13', ~tid.1, $certificate_extensions.2>
                                ) ▶₁ #vr.15 )
                    next
                      case Adv_Recv_TLS_case_3
                      solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                       <'13', ~tid.1, $certificate_extensions.2>
                             ) ▶₁ #vr.15 )
                        case Send_TLS_Channel_owner_uni
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adv_Recv_TLS_case_4
                      solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                       <'13', ~tid.1, $certificate_extensions.2>
                             ) ▶₁ #vr.15 )
                        case Send_TLS_Channel_owner_bi
                        by contradiction /* cyclic */
                      qed
                    next
                      case Adv_Recv_TLS_case_5
                      solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                       <'13', ~tid.1, $certificate_extensions.2>
                             ) ▶₁ #vr.15 )
                        case Send_TLS_Channel_owner_uni
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              next
                case Send_TLS_Channel_owner_uni_case_2
                solve( !Exporters( ~ms.1, 'server', ~tid, hccc.1, hccs.1, fmc.1,
                                   fms.1
                       ) ▶₀ #j.1 )
                  case Create_TLS_channel_uni
                  solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                         ) ▶₃ #k )
                    case Create_TLS_channel_uni
                    solve( Start( ~tid.1, $TP.1, $S, 'client' ) @ #vr.3 )
                      case C_0
                      solve( Start( ~tid.1, $C.1, $S.1, 'client' ) @ #vr.3 )
                        case C_0
                        solve( TLS_Recv( ~tid, 'place_holder', $S,
                                         <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                          <'15', 
                                           sign(<'ExportedAuthenticator', 
                                                 h(<
                                                    Expand(Expand(Expand(~ms,
                                                                         <'32', 
                                                                          'TLS13exportermastersecret', 
                                                                          h(~n)>,
                                                                         '32'),
                                                                  <'32', 
                                                                   'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                   'empty'>,
                                                                  '32'),
                                                           <'32', 'exporter', h(<'empty', '32'>)>,
                                                           '32'), 
                                                    <'13', certificate_request_context.1, 
                                                     $certificate_extensions.1>, 
                                                    pk(~ltkA.1)>)
                                                >,
                                                ~ltkA.1)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorfinishedkey', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                Expand(Expand(Expand(~ms,
                                                                     <'32', 
                                                                      'TLS13exportermastersecret', 
                                                                      h(~n)>,
                                                                     '32'),
                                                              <'32', 
                                                               'EXPORTER_clientauthenticatorhandshakecontext', 
                                                               'empty'>,
                                                              '32'),
                                                       <'32', 'exporter', h(<'empty', '32'>)>,
                                                       '32'), 
                                                <'13', certificate_request_context.1, 
                                                 $certificate_extensions.1>, 
                                                <'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                                '15', 
                                                sign(<'ExportedAuthenticator', 
                                                      h(<
                                                         Expand(Expand(Expand(~ms,
                                                                              <'32', 
                                                                               'TLS13exportermastersecret', 
                                                                               h(~n)>,
                                                                              '32'),
                                                                       <'32', 
                                                                        'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                        'empty'>,
                                                                       '32'),
                                                                <'32', 'exporter', 
                                                                 h(<'empty', '32'>)>,
                                                                '32'), 
                                                         <'13', certificate_request_context.1, 
                                                          $certificate_extensions.1>, 
                                                         pk(~ltkA.1)>)
                                                     >,
                                                     ~ltkA.1)
                                               >)
                                         >
                               ) ▶₁ #k )
                          case Send_TLS_Channel_owner_uni_case_1
                          solve( !KU( ~tid.1 ) @ #vk.1 )
                            case Adv_Recv_TLS_case_1
                            by solve( TLS_Recv( ~tid.2, $S.3, $PH,
                                                <'13', ~tid.1, $certificate_extensions.2>
                                      ) ▶₁ #vr.18 )
                          next
                            case Adv_Recv_TLS_case_2
                            by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                <'13', ~tid.1, $certificate_extensions.2>
                                      ) ▶₁ #vr.18 )
                          next
                            case Adv_Recv_TLS_case_3
                            solve( TLS_Recv( ~tid.2, $C.2, $S.3,
                                             <'13', ~tid.1, $certificate_extensions.2>
                                   ) ▶₁ #vr.18 )
                              case Send_TLS_Channel_owner_uni
                              by contradiction /* cyclic */
                            qed
                          next
                            case Adv_Recv_TLS_case_4
                            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                             <'13', ~tid.1, $certificate_extensions.2>
                                   ) ▶₁ #vr.18 )
                              case Send_TLS_Channel_owner_bi
                              by contradiction /* cyclic */
                            qed
                          next
                            case Adv_Recv_TLS_case_5
                            solve( TLS_Recv( ~tid.2, $C.3, $S.3,
                                             <'13', ~tid.1, $certificate_extensions.2>
                                   ) ▶₁ #vr.18 )
                              case Send_TLS_Channel_owner_uni
                              by contradiction /* cyclic */
                            qed
                          qed
                        next
                          case Send_TLS_Channel_owner_uni_case_2
                          solve( Start( ~tid.1, $TP, $S, 'client' ) @ #vr.3 )
                            case C_0
                            by contradiction /* from formulas */
                          qed
                        next
                          case Send_TLS_Channel_owner_uni_case_3
                          solve( Start( ~tid.1, $TP, $S, 'client' ) @ #vr.3 )
                            case C_0
                            by contradiction /* from formulas */
                          qed
                        next
                          case Send_TLS_Channel_owner_uni_case_4
                          solve( Start( ~tid.1, $TP, $S, 'client' ) @ #vr.3 )
                            case C_0
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Send_TLS_Channel_owner_uni_case_3
                solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                 <'13', ~certificate_request_context, $certificate_extensions>
                       ) ▶₁ #vr.6 )
                  case Send_TLS_Channel_target_case_1
                  by solve( Start( ~tid, $S.1, $PH, 'client' ) @ #j.1 )
                next
                  case Send_TLS_Channel_target_case_2
                  solve( Start( ~tid.2, $TP.1, $S, 'client' ) @ #vr.3 )
                    case C_0
                    solve( Start( ~tid, $PH, $S.1, 'server' ) @ #j.1 )
                      case S_0
                      solve( Start( ~tid.2, $C.2, 'place_holder', 'client' ) @ #vr.3 )
                        case C_0
                        solve( !Exporters( ~ms.1, 'server', ~tid, hccc.1, hccs.1, fmc.1,
                                           fms.1
                               ) ▶₀ #j.1 )
                          case Create_TLS_channel_uni
                          solve( !Exporters( ~ms.1, 'server', ~tid.1, hccc.1, hccs.1, fmc.1,
                                             fms.1
                                 ) ▶₀ #j.2 )
                            case Create_Adv_TLS_channel
                            by solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                                      ) ▶₃ #k )
                          next
                            case Create_TLS_channel_bi
                            by solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                                      ) ▶₃ #k )
                          next
                            case Create_TLS_channel_uni
                            solve( !Exporters( ~ms, 'server', ~tid.1, hccc, hccs, fmc, fms
                                   ) ▶₃ #k )
                              case Create_TLS_channel_uni
                              solve( TLS_Recv( ~tid, 'place_holder', 'place_holder',
                                               <<'11', certificate_request_context.1, pk(~ltkA.1)>, 
                                                <'15', 
                                                 sign(<'ExportedAuthenticator', 
                                                       h(<
                                                          Expand(Expand(Expand(~ms,
                                                                               <'32', 
                                                                                'TLS13exportermastersecret', 
                                                                                h(~n)>,
                                                                               '32'),
                                                                        <'32', 
                                                                         'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                         'empty'>,
                                                                        '32'),
                                                                 <'32', 'exporter', 
                                                                  h(<'empty', '32'>)>,
                                                                 '32'), 
                                                          <'13', certificate_request_context.1, 
                                                           $certificate_extensions.1>, 
                                                          pk(~ltkA.1)>)
                                                      >,
                                                      ~ltkA.1)
                                                >, 
                                                '20', 
                                                hmac(<
                                                      Expand(Expand(Expand(~ms,
                                                                           <'32', 
                                                                            'TLS13exportermastersecret', 
                                                                            h(~n)>,
                                                                           '32'),
                                                                    <'32', 
                                                                     'EXPORTER_clientauthenticatorfinishedkey', 
                                                                     'empty'>,
                                                                    '32'),
                                                             <'32', 'exporter', h(<'empty', '32'>)>,
                                                             '32'), 
                                                      Expand(Expand(Expand(~ms,
                                                                           <'32', 
                                                                            'TLS13exportermastersecret', 
                                                                            h(~n)>,
                                                                           '32'),
                                                                    <'32', 
                                                                     'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                     'empty'>,
                                                                    '32'),
                                                             <'32', 'exporter', h(<'empty', '32'>)>,
                                                             '32'), 
                                                      <'13', certificate_request_context.1, 
                                                       $certificate_extensions.1>, 
                                                      <'11', certificate_request_context.1, 
                                                       pk(~ltkA.1)>, 
                                                      '15', 
                                                      sign(<'ExportedAuthenticator', 
                                                            h(<
                                                               Expand(Expand(Expand(~ms,
                                                                                    <'32', 
                                                                                     'TLS13exportermastersecret', 
                                                                                     h(~n)>,
                                                                                    '32'),
                                                                             <'32', 
                                                                              'EXPORTER_clientauthenticatorhandshakecontext', 
                                                                              'empty'>,
                                                                             '32'),
                                                                      <'32', 'exporter', 
                                                                       h(<'empty', '32'>)>,
                                                                      '32'), 
                                                               <'13', 
                                                                certificate_request_context.1, 
                                                                $certificate_extensions.1>, 
                                                               pk(~ltkA.1)>)
                                                           >,
                                                           ~ltkA.1)
                                                     >)
                                               >
                                     ) ▶₁ #k )
                                case Send_TLS_Channel_owner_uni_case_1
                                solve( !KU( ~tid.1 ) @ #vk.1 )
                                  case Adv_Recv_TLS_case_1
                                  by solve( TLS_Recv( ~tid.2, $S.2, $PH,
                                                      <'13', ~tid.1, $certificate_extensions.2>
                                            ) ▶₁ #vr.20 )
                                next
                                  case Adv_Recv_TLS_case_2
                                  by solve( TLS_Recv( ~tid.2, $S.1, $PH,
                                                      <'13', ~tid.1, $certificate_extensions.2>
                                            ) ▶₁ #vr.20 )
                                next
                                  case Adv_Recv_TLS_case_3
                                  solve( TLS_Recv( ~tid.2, $C.2, $S.2,
                                                   <'13', ~tid.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.20 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_4
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                   <'13', ~tid.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.20 )
                                    case Send_TLS_Channel_owner_bi
                                    by contradiction /* cyclic */
                                  qed
                                next
                                  case Adv_Recv_TLS_case_5
                                  solve( TLS_Recv( ~tid.2, $C.3, $S.2,
                                                   <'13', ~tid.1, $certificate_extensions.2>
                                         ) ▶₁ #vr.20 )
                                    case Send_TLS_Channel_owner_uni
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case Send_TLS_Channel_owner_uni_case_2
                                solve( Start( ~tid.1, $TP, 'place_holder', 'client' ) @ #vr.3 )
                                  case C_0
                                  by contradiction /* from formulas */
                                qed
                              next
                                case Send_TLS_Channel_owner_uni_case_3
                                solve( Start( ~tid.1, $C.1, $S, 'client' ) @ #vr.3 )
                                  case C_0
                                  solve( Start( ~tid.1, $TP, 'place_holder', 'client' ) @ #vr.3 )
                                    case C_0
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case Send_TLS_Channel_owner_uni_case_4
                                solve( Start( ~tid.1, $TP, 'place_holder', 'client' ) @ #vr.3 )
                                  case C_0
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Send_TLS_Channel_owner_uni_case_4
                solve( Start( ~tid.2, $TP.1, $S, 'client' ) @ #vr.3 )
                  case C_0
                  by solve( Start( ~tid.2, $S.1, $C.2, 'server' ) @ #vr.3 )
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

/* All well-formedness checks were successful. */

end